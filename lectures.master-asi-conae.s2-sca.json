{"version":3,"kind":"Notebook","sha256":"e95d9bd78142632ed76cb69ef339e8a40d8c99e82026bd26b65d3478c8e36d71","slug":"lectures.master-asi-conae.s2-sca","location":"/lectures/9.9_master_asi_conae/s2_sca.ipynb","dependencies":[],"frontmatter":{"title":"Sentinel-2 snow cover area (SCA) time series","content_includes_title":false,"kernelspec":{"name":"conda-env-default-py","display_name":"default *","language":"python"},"github":"https://github.com/EO-college/cubes-and-clouds","subject":"Cubes and Clouds learning materials","numbering":{"title":{"offset":2}},"source_url":"https://github.com/EO-college/cubes-and-clouds/blob/main/lectures/9.9_master_asi_conae/s2_sca.ipynb","edit_url":"https://github.com/EO-college/cubes-and-clouds/edit/main/lectures/9.9_master_asi_conae/s2_sca.ipynb","exports":[{"format":"ipynb","filename":"s2_sca.ipynb","url":"/cubes-and-clouds/build/s2_sca-836e8631ca6a9013f69b2f5a907b31e0.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This notebook will show how to generate a snow cover area time series for a given catchment of interest from Sentinel-2 images.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KqoEad4ip8"}],"key":"bXTZwVd44U"}],"key":"GfAr7GfSho"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Importing dependencies","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DAhC042UXW"}],"identifier":"importing-dependencies","label":"Importing dependencies","html_id":"importing-dependencies","implicit":true,"key":"TJ1wbi1eqC"}],"key":"ILfz3xxvqm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# xcube_sh imports\nfrom xcube_sh.cube import open_cube\nfrom xcube_sh.config import CubeConfig\nfrom xcube_sh.sentinelhub import SentinelHub\n\n# xcube imports\nfrom xcube.core.geom import mask_dataset_by_geometry\n\n# Various utilities\nfrom datetime import date\nimport numpy as np\nimport pandas as pd\nimport geopandas as gpd\nimport matplotlib.pyplot as plt\n\nimport folium","key":"Z9eaAcFlwC"},{"type":"outputs","id":"05X7As68p14F0c2RZVnuJ","children":[],"key":"atDjPPNJDh"}],"key":"Z6jxC3gJDd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select a region of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T2P4daYMJV"}],"identifier":"select-a-region-of-interest","label":"Select a region of interest","html_id":"select-a-region-of-interest","implicit":true,"key":"lauSTVObJa"}],"key":"ccm9cU06oS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load and visualize a test catchment outline which will be used as a reogion of interest in this example","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FXkNnaqe9E"}],"key":"JriEVwtxtk"}],"key":"nd39N5uITL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"catchment_outline = gpd.read_file('catchment_outline.geojson')","key":"Rr7YlCb2G8"},{"type":"outputs","id":"yPkkChq8cXk7K7201z1VH","children":[],"key":"xt03Bo3Q5y"}],"key":"CMofSggUjq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = folium.Map(location=[catchment_outline.centroid.y, catchment_outline.centroid.x])\nfolium.GeoJson(data=catchment_outline.to_json(), name='catchment').add_to(m)\nm","key":"YPAjVgtT57"},{"type":"outputs","id":"VWRtaT7MHzvEypIv1hA7e","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_72/1928884253.py:1: UserWarning: Geometry is in a geographic CRS. Results from 'centroid' are likely incorrect. Use 'GeoSeries.to_crs()' to re-project geometries to a projected CRS before this operation.\n\n  m = folium.Map(location=[catchment_outline.centroid.y, catchment_outline.centroid.x])\n/tmp/ipykernel_72/1928884253.py:1: UserWarning: Geometry is in a geographic CRS. Results from 'centroid' are likely incorrect. Use 'GeoSeries.to_crs()' to re-project geometries to a projected CRS before this operation.\n\n  m = folium.Map(location=[catchment_outline.centroid.y, catchment_outline.centroid.x])\n"},"children":[],"key":"iZllSJY6KI"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc=\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    \n    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\n    \n        &lt;script&gt;\n            L_NO_TOUCH = false;\n            L_DISABLE_3D = false;\n        &lt;/script&gt;\n    \n    &lt;style&gt;html, body {width: 100%;height: 100%;margin: 0;padding: 0;}&lt;/style&gt;\n    &lt;style&gt;#map {position:absolute;top:0;bottom:0;right:0;left:0;}&lt;/style&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://code.jquery.com/jquery-1.12.4.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;\n    \n            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,\n                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;\n            &lt;style&gt;\n                #map_e66e8444502749eea0129f39570ffc5a {\n                    position: relative;\n                    width: 100.0%;\n                    height: 100.0%;\n                    left: 0.0%;\n                    top: 0.0%;\n                }\n                .leaflet-container { font-size: 1rem; }\n            &lt;/style&gt;\n        \n&lt;/head&gt;\n&lt;body&gt;\n    \n    \n            &lt;div class=&quot;folium-map&quot; id=&quot;map_e66e8444502749eea0129f39570ffc5a&quot; &gt;&lt;/div&gt;\n        \n&lt;/body&gt;\n&lt;script&gt;\n    \n    \n            var map_e66e8444502749eea0129f39570ffc5a = L.map(\n                &quot;map_e66e8444502749eea0129f39570ffc5a&quot;,\n                {\n                    center: [46.79856263096177, 11.177346530561929],\n                    crs: L.CRS.EPSG3857,\n                    zoom: 10,\n                    zoomControl: true,\n                    preferCanvas: false,\n                }\n            );\n\n            \n\n        \n    \n            var tile_layer_1b76f41eca50408b74380844d622d784 = L.tileLayer(\n                &quot;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,\n                {&quot;attribution&quot;: &quot;Data by \\u0026copy; \\u003ca target=\\&quot;_blank\\&quot; href=\\&quot;http://openstreetmap.org\\&quot;\\u003eOpenStreetMap\\u003c/a\\u003e, under \\u003ca target=\\&quot;_blank\\&quot; href=\\&quot;http://www.openstreetmap.org/copyright\\&quot;\\u003eODbL\\u003c/a\\u003e.&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 18, &quot;maxZoom&quot;: 18, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}\n            ).addTo(map_e66e8444502749eea0129f39570ffc5a);\n        \n    \n\n        function geo_json_63e05984c60cdf9e686bf0473671a361_onEachFeature(feature, layer) {\n            layer.on({\n            });\n        };\n        var geo_json_63e05984c60cdf9e686bf0473671a361 = L.geoJson(null, {\n                onEachFeature: geo_json_63e05984c60cdf9e686bf0473671a361_onEachFeature,\n            \n        });\n\n        function geo_json_63e05984c60cdf9e686bf0473671a361_add (data) {\n            geo_json_63e05984c60cdf9e686bf0473671a361\n                .addData(data)\n                .addTo(map_e66e8444502749eea0129f39570ffc5a);\n        }\n            geo_json_63e05984c60cdf9e686bf0473671a361_add({&quot;features&quot;: [{&quot;geometry&quot;: {&quot;coordinates&quot;: [[[[11.075, 46.72916666666669], [11.072575547960094, 46.728813340928845], [11.069091118706622, 46.72535332573787], [11.048285590277802, 46.724646674262175], [11.042024739583358, 46.73087632921009], [11.041666666666691, 46.733333333333356], [11.038123575846377, 46.73424241807728], [11.0375, 46.74583333333336], [11.03664923773874, 46.74914923773874], [11.030017428927975, 46.75085076226131], [11.028599378797768, 46.756377156575546], [11.025567287868947, 46.76028951009117], [11.0244327121311, 46.76471048990888], [11.02140062120228, 46.7686228434245], [11.020833333333357, 46.77083333333336], [11.024291653103322, 46.77172071668839], [11.025567287868947, 46.781377156575545], [11.032766045464435, 46.78945617675784], [11.033900621202282, 46.79387715657555], [11.036932712131101, 46.79778951009117], [11.038067287868948, 46.80221048990888], [11.042586263020858, 46.80762905544707], [11.052210489908878, 46.808900621202284], [11.06028951009117, 46.816099378797766], [11.06471048990888, 46.81723395453562], [11.068622843424503, 46.820266045464436], [11.073043823242212, 46.82140062120228], [11.077974107530407, 46.82522176106773], [11.079733954535614, 46.83010389539933], [11.071295166015648, 46.83957451714412], [11.0744327121311, 46.843622843424505], [11.075567287868948, 46.846579996744815], [11.071400621202281, 46.85195617675784], [11.070266045464434, 46.859321424696205], [11.082766045464435, 46.872789510091174], [11.084041680230058, 46.882445949978326], [11.089710489908878, 46.88390062120228], [11.09995964898006, 46.89319695366756], [11.096400621202282, 46.89778951009117], [11.095266045464435, 46.91343722873266], [11.103599378797767, 46.92278951009117], [11.104166666666691, 46.929166666666696], [11.114924452039954, 46.92951999240454], [11.11875, 46.9333187527127], [11.12328694661461, 46.92881334092885], [11.139924452039956, 46.92951999240454], [11.143408881293428, 46.93298000759551], [11.148288302951414, 46.933691067165825], [11.157980007595512, 46.94340888129343], [11.158691406250025, 46.948290337456626], [11.16424221462676, 46.953813340928846], [11.166666666666693, 46.954166666666694], [11.167024739583358, 46.95170966254343], [11.172575547960095, 46.94618665907121], [11.177424452039956, 46.94548000759551], [11.180908881293428, 46.94201999240454], [11.185757785373289, 46.94131334092884], [11.189242214626761, 46.937853325737876], [11.194123670789956, 46.93714192708336], [11.199646674262178, 46.93159111870662], [11.200353325737872, 46.9100755479601], [11.204519992404538, 46.90587972005211], [11.203813340928845, 46.901742214626765], [11.199646674262178, 46.89754638671877], [11.200353325737872, 46.89340888129343], [11.203813340928845, 46.889924452039956], [11.204519992404538, 46.8850755479601], [11.21248609754777, 46.877084011501765], [11.208686659071207, 46.87325778537329], [11.208333333333359, 46.85833333333336], [11.210543823242213, 46.85776604546444], [11.214456176757839, 46.85473395453562], [11.231377156575547, 46.85359937879777], [11.239456176757837, 46.846400621202285], [11.260543823242212, 46.845266045464435], [11.26458333333336, 46.84213528103301], [11.26875, 46.84536471896704], [11.272789510091172, 46.842233954535615], [11.323043823242214, 46.84109937879777], [11.331122843424506, 46.83390062120228], [11.343877156575548, 46.83276604546444], [11.347789510091172, 46.82973395453561], [11.35331590440541, 46.82831590440541], [11.354733954535616, 46.82278951009117], [11.357766045464437, 46.818877156575546], [11.358900621202284, 46.81445617675784], [11.36609937879777, 46.80637715657554], [11.366666666666694, 46.80416666666669], [11.365779283311658, 46.80070834689673], [11.356122843424506, 46.7994327121311], [11.35208333333336, 46.796301947699675], [11.347916666666693, 46.799531385633706], [11.343877156575548, 46.79640062120228], [11.339456176757839, 46.79526604546444], [11.335543823242213, 46.79223395453562], [11.321806165907145, 46.79101189507381], [11.31306728786895, 46.781377156575545], [11.311932712131103, 46.776956176757835], [11.304733954535617, 46.76887715657555], [11.30359937879777, 46.76445617675784], [11.30056728786895, 46.760543823242216], [11.299149237738742, 46.75501742892798], [11.293622843424505, 46.753599378797766], [11.289710489908881, 46.75056728786895], [11.279166666666693, 46.75], [11.278813340928846, 46.73924221462676], [11.27464667426218, 46.73504638671878], [11.275353325737873, 46.73090888129343], [11.283319430881102, 46.722917344835096], [11.27951999240454, 46.71909111870662], [11.278813340928846, 46.705908881293425], [11.275353325737873, 46.702424452039956], [11.275, 46.7], [11.274032253689262, 46.69622938368058], [11.267413330078151, 46.691099378797766], [11.260289510091171, 46.69223395453562], [11.25491333007815, 46.69640062120228], [11.251956176757838, 46.695266045464436], [11.248043823242213, 46.69223395453562], [11.239456176757837, 46.691099378797766], [11.235543823242214, 46.68806728786895], [11.218622843424505, 46.6869327121311], [11.21471048990888, 46.683900621202284], [11.197789510091171, 46.68276604546443], [11.193877156575546, 46.679733954535614], [11.184220716688394, 46.67845831976999], [11.182413736979193, 46.671416219075546], [11.173043823242214, 46.66306728786895], [11.168622843424505, 46.6619327121311], [11.159270562065997, 46.653599378797765], [11.154985215928845, 46.655143907335095], [11.154166666666692, 46.65833333333336], [11.15085076226131, 46.65918409559464], [11.15, 46.6625], [11.150353325737871, 46.66909111870662], [11.155876329210095, 46.67464192708336], [11.160757785373288, 46.67535332573787], [11.166668023003497, 46.68123406304256], [11.162853325737872, 46.685075547960096], [11.162146674262178, 46.68992445203995], [11.15451999240454, 46.69757554796009], [11.153813340928846, 46.702424452039956], [11.148290337456622, 46.70797526041669], [11.143408881293428, 46.708686659071205], [11.139924452039956, 46.71214667426218], [11.122575547960095, 46.712853325737875], [11.119091118706622, 46.71631334092884], [11.11424221462676, 46.71701999240454], [11.110757785373288, 46.72048000759551], [11.10174221462676, 46.72118665907121], [11.098257785373288, 46.724646674262175], [11.085075547960095, 46.72535332573787], [11.081591118706623, 46.728813340928845], [11.075, 46.72916666666669]]]], &quot;type&quot;: &quot;MultiPolygon&quot;}, &quot;id&quot;: &quot;0&quot;, &quot;properties&quot;: {&quot;COAST&quot;: 0, &quot;DIST_MAIN&quot;: 334.5, &quot;DIST_SINK&quot;: 334.5, &quot;ENDO&quot;: 0, &quot;HYBAS_ID&quot;: 2090516090, &quot;MAIN_BAS&quot;: 2090012980, &quot;NEXT_DOWN&quot;: 2090516950, &quot;NEXT_SINK&quot;: 2090012980, &quot;ORDER&quot;: 3, &quot;PFAF_ID&quot;: 214040804, &quot;SORT&quot;: 10988, &quot;SUB_AREA&quot;: 419.1, &quot;UP_AREA&quot;: 419.2}, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;});\n\n        \n&lt;/script&gt;\n&lt;/html&gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>","content_type":"text/html"},"text/plain":{"content":"<folium.folium.Map at 0x7fd48ab6e490>","content_type":"text/plain"}}},"children":[],"key":"JQATju0eNm"}],"key":"LPSwyxlPZo"}],"key":"zR7kQzJHfL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Configuring the data content of the cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Irji1BX2Cj"}],"identifier":"configuring-the-data-content-of-the-cube","label":"Configuring the data content of the cube","html_id":"configuring-the-data-content-of-the-cube","implicit":true,"key":"EldwxH4uyW"}],"key":"I6TrFPW4l9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We need to set the following configuration input variable to define the content of the data cube we want to access","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F0d7etUNmA"}],"key":"wkglZgjJL3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"dataset name","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OMvJiaFBqM"}],"key":"sxd8Nim279"}],"key":"DMpWNXY4jZ"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"band names","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UbU1lEEhRC"}],"key":"InsJJQ8a6f"}],"key":"pov5sQ7CQK"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"time range","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"aIcb6zZZ4e"}],"key":"JWRTcAYuB6"}],"key":"xgwB6Wqj5F"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"the area of interest specifed via bounding box coordinates","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FzFVquGu5N"}],"key":"QON5Xb94nd"}],"key":"J4r3KyaQE8"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"spatial resolution","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"U6a9gI6ch0"}],"key":"sjchyPMjEH"}],"key":"HEzkIBnWgE"}],"key":"Vu5tEqzQgn"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"To select the correct dataset we can first list all the available dataset:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"IOStD0SWTW"}],"key":"FF8xepbNuw"}],"key":"O6MMLowIfZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"SH = SentinelHub()\nSH.dataset_names","key":"yXZ4awcct2"},{"type":"outputs","id":"oSnzdkXjVFrfhSpCiHHKd","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"['LETML1',\n 'LOTL1',\n 'LETML2',\n 'CUSTOM',\n 'LMSSL1',\n 'LTML2',\n 'LOTL2',\n 'S3OLCI',\n 'S3SLSTR',\n 'DEM',\n 'MODIS',\n 'S5PL2',\n 'HLS',\n 'LTML1',\n 'S1GRD',\n 'S2L2A',\n 'S2L1C']","content_type":"text/plain"}}},"children":[],"key":"qp1laEU9qT"}],"key":"J46w8bQ43v"}],"key":"nc61fjj30H"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We want to use the Sentinel-2 L2A product. Then the configuration variable ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uwYw3A1Fig"},{"type":"inlineCode","value":"dataset_name","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RzOxpne32H"},{"type":"text","value":" can be set equal to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tbbd7mgO4C"},{"type":"inlineCode","value":"'S2L2A'","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HKjJN4xKNH"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FtkFGVccsq"}],"key":"DRiWjzU1IG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Then we can visualize all the bands for the S2L2A dataset (the documentation to this dataset can be read at ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QAEhl7O1Rn"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/data/sentinel-2-l2a/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​docs​.sentinel​-hub​.com​/api​/latest​/data​/sentinel​-2​-l2a/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nwhnxvcgyv"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/data/sentinel-2-l2a/","key":"UYCc4ZXzcC"},{"type":"text","value":"):","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dhuOViDqmJ"}],"key":"b5wVueSdxy"}],"key":"ussPeO8R8A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"SH.band_names('S2L2A')","key":"mW9tMYc2IX"},{"type":"outputs","id":"G3xd672wwddpNr8yAoK9l","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"['B01',\n 'B02',\n 'B03',\n 'B04',\n 'B05',\n 'B06',\n 'B07',\n 'B08',\n 'B8A',\n 'B09',\n 'B11',\n 'B12',\n 'SCL',\n 'SNW',\n 'CLD',\n 'viewZenithMean',\n 'viewAzimuthMean',\n 'sunZenithAngles',\n 'sunAzimuthAngles',\n 'AOT',\n 'CLM',\n 'CLP']","content_type":"text/plain"}}},"children":[],"key":"fvnVFtQ1sn"}],"key":"c8PASydQgl"}],"key":"nIKDPT1rZU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As a time range we will focus on the snow melting season 2018, in particular from Febraury to June 2018:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VVxl2FScIV"}],"key":"FKJBDxrr7e"}],"key":"Y8cnURL6cs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_date = date(2018, 2, 1)\nend_date = date(2018, 6, 30)","key":"xhkWxll6jo"},{"type":"outputs","id":"VrUL-W8tv75047bEdUc4F","children":[],"key":"KOHBdH7eIo"}],"key":"B8BPE4S253"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we need to extract the bounding box of the catchment outline, which will be used to access the needed Sentinel-2 data in our region of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yEZymUUzXZ"}],"key":"zUcQgRwtmt"}],"key":"Xi7g37E160"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bbox = catchment_outline.bounds.iloc[0]\nbbox","key":"yp0ZekX6Xi"},{"type":"outputs","id":"CRuBLDziL8fKVxX4KetsF","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"minx    11.020833\nminy    46.653599\nmaxx    11.366667\nmaxy    46.954167\nName: 0, dtype: float64","content_type":"text/plain"}}},"children":[],"key":"p7boV2CbnG"}],"key":"jOwWhoSf41"}],"key":"o9ZmGHE0Eo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a Sentinel-2 RGB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yynSABP8kz"}],"identifier":"create-a-sentinel-2-rgb","label":"Create a Sentinel-2 RGB","html_id":"create-a-sentinel-2-rgb","implicit":true,"key":"SjGqrUJ50T"}],"key":"dLjfhSBIcs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As a first step we will create a RGB data cube from Sentinel-2, including a cloud cover map (CLM). This can be useful to visualize the Sentinel-2 images for some specific date. The spatial resolution set for this cube will be 0.00018 degree, which correspond roughly to the native 10 meter resolution of the Sentinel-2 visible bands (B02: blue, B03: green, B04: red)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kQ7vGauIeg"}],"key":"EIDuuXnXO8"}],"key":"xr4gZlOBYg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_config_s2rgb = CubeConfig(\n    dataset_name='S2L2A',\n    band_names=['B02', 'B03', 'B04', 'CLM'],\n    bbox=bbox.tolist(),\n    spatial_res=0.00018,\n    time_range=[start_date.strftime(\"%Y-%m-%d\"), end_date.strftime(\"%Y-%m-%d\")]\n)","key":"BTR3HfDmKR"},{"type":"outputs","id":"7pWB0bMq4yRhKqNL7B12b","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/conda/master-asi-conae/315434deb1b1e05eacacc41e1b0529b1837100f46402a32041d77ba54ae6c5f3-20230213-125825-013239-74-edc-2022.10-14/lib/python3.9/site-packages/xcube_sh/config.py:248: FutureWarning: Units 'M', 'Y' and 'y' do not represent unambiguous timedelta values and will be removed in a future version.\n  time_tolerance = pd.to_timedelta(time_tolerance)\n"},"children":[],"key":"AdIIlF63nN"}],"key":"TnzBQwtjXi"}],"key":"D7pzuPH57h"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Loading the data into the cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BmtIY9C48w"}],"key":"AlhVwdDcNv"}],"key":"GBflZhMcxv"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2rgb = open_cube(cube_config_s2rgb)\ncube_s2rgb","visibility":"show","key":"Q5MCNOqcEe"},{"type":"outputs","id":"j7jTXEzD-R_9lf8yFob5q","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"822117cabed98a6c8b9bfe38da7577fd","path":"/cubes-and-clouds/build/822117cabed98a6c8b9bfe38da7577fd.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:    (time: 58, lat: 1864, lon: 2146, bnds: 2)\nCoordinates:\n  * lat        (lat) float64 46.99 46.99 46.99 46.99 ... 46.65 46.65 46.65 46.65\n  * lon        (lon) float64 11.02 11.02 11.02 11.02 ... 11.41 11.41 11.41 11.41\n  * time       (time) datetime64[ns] 2018-02-01T10:22:37 ... 2018-06-28T10:13:58\n    time_bnds  (time, bnds) datetime64[ns] dask.array<chunksize=(58, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B02        (time, lat, lon) float32 dask.array<chunksize=(1, 932, 1073), meta=np.ndarray>\n    B03        (time, lat, lon) float32 dask.array<chunksize=(1, 932, 1073), meta=np.ndarray>\n    B04        (time, lat, lon) float32 dask.array<chunksize=(1, 932, 1073), meta=np.ndarray>\n    CLM        (time, lat, lon) float32 dask.array<chunksize=(1, 932, 1073), meta=np.ndarray>\nAttributes:\n    Conventions:             CF-1.7\n    title:                   S2L2A Data Cube Subset\n    history:                 [{'program': 'xcube_sh.chunkstore.SentinelHubChu...\n    date_created:            2023-02-21T09:43:08.149994\n    time_coverage_start:     2018-02-01T10:22:37+00:00\n    time_coverage_end:       2018-06-28T10:13:58+00:00\n    time_coverage_duration:  P146DT23H51M21S\n    geospatial_lon_min:      11.020833333333357\n    geospatial_lat_min:      46.653599378797765\n    geospatial_lon_max:      11.407113333333356\n    geospatial_lat_max:      46.98911937879777\n    processing_level:        L2A","content_type":"text/plain"}}},"children":[],"key":"CtOwfHpm4n"}],"visibility":"show","key":"iLQIqpb9S5"}],"visibility":"show","key":"IyJw4e20xF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Show the date list of the data in the cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XVIgsOvFsI"}],"key":"INhpm7HEW3"}],"key":"DloOUR7Dm3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2rgb.time","key":"njJR2rTroC"},{"type":"outputs","id":"ARvBvSKvtsC04ZQfEjF33","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 20px 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: none;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;time&#x27; (time: 58)&gt;\narray([&#x27;2018-02-01T10:22:37.000000000&#x27;, &#x27;2018-02-03T10:12:37.000000000&#x27;,\n       &#x27;2018-02-06T10:22:06.000000000&#x27;, &#x27;2018-02-08T10:11:53.000000000&#x27;,\n       &#x27;2018-02-11T10:25:59.000000000&#x27;, &#x27;2018-02-13T10:15:59.000000000&#x27;,\n       &#x27;2018-02-16T10:26:01.000000000&#x27;, &#x27;2018-02-18T10:13:13.000000000&#x27;,\n       &#x27;2018-02-21T10:20:33.000000000&#x27;, &#x27;2018-02-23T10:15:08.000000000&#x27;,\n       &#x27;2018-02-26T10:20:50.000000000&#x27;, &#x27;2018-02-28T10:10:21.000000000&#x27;,\n       &#x27;2018-03-03T10:27:07.000000000&#x27;, &#x27;2018-03-05T10:13:15.000000000&#x27;,\n       &#x27;2018-03-08T10:22:41.000000000&#x27;, &#x27;2018-03-10T10:10:20.000000000&#x27;,\n       &#x27;2018-03-13T10:25:40.000000000&#x27;, &#x27;2018-03-15T10:10:38.000000000&#x27;,\n       &#x27;2018-03-20T10:10:21.000000000&#x27;, &#x27;2018-03-23T10:20:21.000000000&#x27;,\n       &#x27;2018-03-25T10:15:11.000000000&#x27;, &#x27;2018-03-28T10:23:58.000000000&#x27;,\n       &#x27;2018-03-30T10:16:20.000000000&#x27;, &#x27;2018-04-02T10:24:35.000000000&#x27;,\n       &#x27;2018-04-04T10:10:21.000000000&#x27;, &#x27;2018-04-07T10:20:20.000000000&#x27;,\n       &#x27;2018-04-09T10:13:43.000000000&#x27;, &#x27;2018-04-12T10:20:24.000000000&#x27;,\n       &#x27;2018-04-14T10:15:36.000000000&#x27;, &#x27;2018-04-17T10:20:21.000000000&#x27;,\n       &#x27;2018-04-19T10:14:57.000000000&#x27;, &#x27;2018-04-22T10:21:15.000000000&#x27;,\n       &#x27;2018-04-24T10:15:26.000000000&#x27;, &#x27;2018-04-27T10:20:22.000000000&#x27;,\n       &#x27;2018-04-29T10:12:58.000000000&#x27;, &#x27;2018-05-02T10:24:34.000000000&#x27;,\n       &#x27;2018-05-04T10:10:23.000000000&#x27;, &#x27;2018-05-07T10:26:48.000000000&#x27;,\n       &#x27;2018-05-09T10:16:21.000000000&#x27;, &#x27;2018-05-12T10:21:48.000000000&#x27;,\n       &#x27;2018-05-14T10:10:52.000000000&#x27;, &#x27;2018-05-17T10:22:09.000000000&#x27;,\n       &#x27;2018-05-19T10:12:07.000000000&#x27;, &#x27;2018-05-22T10:20:25.000000000&#x27;,\n       &#x27;2018-05-24T10:10:22.000000000&#x27;, &#x27;2018-05-29T10:12:25.000000000&#x27;,\n       &#x27;2018-06-01T10:20:24.000000000&#x27;, &#x27;2018-06-03T10:13:29.000000000&#x27;,\n       &#x27;2018-06-06T10:25:12.000000000&#x27;, &#x27;2018-06-08T10:17:26.000000000&#x27;,\n       &#x27;2018-06-11T10:26:34.000000000&#x27;, &#x27;2018-06-13T10:14:24.000000000&#x27;,\n       &#x27;2018-06-16T10:20:21.000000000&#x27;, &#x27;2018-06-18T10:17:33.000000000&#x27;,\n       &#x27;2018-06-21T10:23:16.000000000&#x27;, &#x27;2018-06-23T10:11:39.000000000&#x27;,\n       &#x27;2018-06-26T10:26:26.000000000&#x27;, &#x27;2018-06-28T10:13:58.000000000&#x27;],\n      dtype=&#x27;datetime64[ns]&#x27;)\nCoordinates:\n  * time     (time) datetime64[ns] 2018-02-01T10:22:37 ... 2018-06-28T10:13:58\nAttributes:\n    standard_name:  time\n    bounds:         time_bnds</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'time'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 58</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-812432b6-3e5b-473f-9f35-f6753172e759' class='xr-array-in' type='checkbox' checked><label for='section-812432b6-3e5b-473f-9f35-f6753172e759' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>2018-02-01T10:22:37 2018-02-03T10:12:37 ... 2018-06-28T10:13:58</span></div><div class='xr-array-data'><pre>array([&#x27;2018-02-01T10:22:37.000000000&#x27;, &#x27;2018-02-03T10:12:37.000000000&#x27;,\n       &#x27;2018-02-06T10:22:06.000000000&#x27;, &#x27;2018-02-08T10:11:53.000000000&#x27;,\n       &#x27;2018-02-11T10:25:59.000000000&#x27;, &#x27;2018-02-13T10:15:59.000000000&#x27;,\n       &#x27;2018-02-16T10:26:01.000000000&#x27;, &#x27;2018-02-18T10:13:13.000000000&#x27;,\n       &#x27;2018-02-21T10:20:33.000000000&#x27;, &#x27;2018-02-23T10:15:08.000000000&#x27;,\n       &#x27;2018-02-26T10:20:50.000000000&#x27;, &#x27;2018-02-28T10:10:21.000000000&#x27;,\n       &#x27;2018-03-03T10:27:07.000000000&#x27;, &#x27;2018-03-05T10:13:15.000000000&#x27;,\n       &#x27;2018-03-08T10:22:41.000000000&#x27;, &#x27;2018-03-10T10:10:20.000000000&#x27;,\n       &#x27;2018-03-13T10:25:40.000000000&#x27;, &#x27;2018-03-15T10:10:38.000000000&#x27;,\n       &#x27;2018-03-20T10:10:21.000000000&#x27;, &#x27;2018-03-23T10:20:21.000000000&#x27;,\n       &#x27;2018-03-25T10:15:11.000000000&#x27;, &#x27;2018-03-28T10:23:58.000000000&#x27;,\n       &#x27;2018-03-30T10:16:20.000000000&#x27;, &#x27;2018-04-02T10:24:35.000000000&#x27;,\n       &#x27;2018-04-04T10:10:21.000000000&#x27;, &#x27;2018-04-07T10:20:20.000000000&#x27;,\n       &#x27;2018-04-09T10:13:43.000000000&#x27;, &#x27;2018-04-12T10:20:24.000000000&#x27;,\n       &#x27;2018-04-14T10:15:36.000000000&#x27;, &#x27;2018-04-17T10:20:21.000000000&#x27;,\n       &#x27;2018-04-19T10:14:57.000000000&#x27;, &#x27;2018-04-22T10:21:15.000000000&#x27;,\n       &#x27;2018-04-24T10:15:26.000000000&#x27;, &#x27;2018-04-27T10:20:22.000000000&#x27;,\n       &#x27;2018-04-29T10:12:58.000000000&#x27;, &#x27;2018-05-02T10:24:34.000000000&#x27;,\n       &#x27;2018-05-04T10:10:23.000000000&#x27;, &#x27;2018-05-07T10:26:48.000000000&#x27;,\n       &#x27;2018-05-09T10:16:21.000000000&#x27;, &#x27;2018-05-12T10:21:48.000000000&#x27;,\n       &#x27;2018-05-14T10:10:52.000000000&#x27;, &#x27;2018-05-17T10:22:09.000000000&#x27;,\n       &#x27;2018-05-19T10:12:07.000000000&#x27;, &#x27;2018-05-22T10:20:25.000000000&#x27;,\n       &#x27;2018-05-24T10:10:22.000000000&#x27;, &#x27;2018-05-29T10:12:25.000000000&#x27;,\n       &#x27;2018-06-01T10:20:24.000000000&#x27;, &#x27;2018-06-03T10:13:29.000000000&#x27;,\n       &#x27;2018-06-06T10:25:12.000000000&#x27;, &#x27;2018-06-08T10:17:26.000000000&#x27;,\n       &#x27;2018-06-11T10:26:34.000000000&#x27;, &#x27;2018-06-13T10:14:24.000000000&#x27;,\n       &#x27;2018-06-16T10:20:21.000000000&#x27;, &#x27;2018-06-18T10:17:33.000000000&#x27;,\n       &#x27;2018-06-21T10:23:16.000000000&#x27;, &#x27;2018-06-23T10:11:39.000000000&#x27;,\n       &#x27;2018-06-26T10:26:26.000000000&#x27;, &#x27;2018-06-28T10:13:58.000000000&#x27;],\n      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></div></li><li class='xr-section-item'><input id='section-3b39dc8b-712a-49a4-afca-084bbec5f472' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3b39dc8b-712a-49a4-afca-084bbec5f472' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2018-02-01T10:22:37 ... 2018-06-...</div><input id='attrs-f781d88e-bd43-4f01-a9b1-91242658f74e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f781d88e-bd43-4f01-a9b1-91242658f74e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-99f56dff-9411-433e-a00d-bc11392d8b23' class='xr-var-data-in' type='checkbox'><label for='data-99f56dff-9411-433e-a00d-bc11392d8b23' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2018-02-01T10:22:37.000000000&#x27;, &#x27;2018-02-03T10:12:37.000000000&#x27;,\n       &#x27;2018-02-06T10:22:06.000000000&#x27;, &#x27;2018-02-08T10:11:53.000000000&#x27;,\n       &#x27;2018-02-11T10:25:59.000000000&#x27;, &#x27;2018-02-13T10:15:59.000000000&#x27;,\n       &#x27;2018-02-16T10:26:01.000000000&#x27;, &#x27;2018-02-18T10:13:13.000000000&#x27;,\n       &#x27;2018-02-21T10:20:33.000000000&#x27;, &#x27;2018-02-23T10:15:08.000000000&#x27;,\n       &#x27;2018-02-26T10:20:50.000000000&#x27;, &#x27;2018-02-28T10:10:21.000000000&#x27;,\n       &#x27;2018-03-03T10:27:07.000000000&#x27;, &#x27;2018-03-05T10:13:15.000000000&#x27;,\n       &#x27;2018-03-08T10:22:41.000000000&#x27;, &#x27;2018-03-10T10:10:20.000000000&#x27;,\n       &#x27;2018-03-13T10:25:40.000000000&#x27;, &#x27;2018-03-15T10:10:38.000000000&#x27;,\n       &#x27;2018-03-20T10:10:21.000000000&#x27;, &#x27;2018-03-23T10:20:21.000000000&#x27;,\n       &#x27;2018-03-25T10:15:11.000000000&#x27;, &#x27;2018-03-28T10:23:58.000000000&#x27;,\n       &#x27;2018-03-30T10:16:20.000000000&#x27;, &#x27;2018-04-02T10:24:35.000000000&#x27;,\n       &#x27;2018-04-04T10:10:21.000000000&#x27;, &#x27;2018-04-07T10:20:20.000000000&#x27;,\n       &#x27;2018-04-09T10:13:43.000000000&#x27;, &#x27;2018-04-12T10:20:24.000000000&#x27;,\n       &#x27;2018-04-14T10:15:36.000000000&#x27;, &#x27;2018-04-17T10:20:21.000000000&#x27;,\n       &#x27;2018-04-19T10:14:57.000000000&#x27;, &#x27;2018-04-22T10:21:15.000000000&#x27;,\n       &#x27;2018-04-24T10:15:26.000000000&#x27;, &#x27;2018-04-27T10:20:22.000000000&#x27;,\n       &#x27;2018-04-29T10:12:58.000000000&#x27;, &#x27;2018-05-02T10:24:34.000000000&#x27;,\n       &#x27;2018-05-04T10:10:23.000000000&#x27;, &#x27;2018-05-07T10:26:48.000000000&#x27;,\n       &#x27;2018-05-09T10:16:21.000000000&#x27;, &#x27;2018-05-12T10:21:48.000000000&#x27;,\n       &#x27;2018-05-14T10:10:52.000000000&#x27;, &#x27;2018-05-17T10:22:09.000000000&#x27;,\n       &#x27;2018-05-19T10:12:07.000000000&#x27;, &#x27;2018-05-22T10:20:25.000000000&#x27;,\n       &#x27;2018-05-24T10:10:22.000000000&#x27;, &#x27;2018-05-29T10:12:25.000000000&#x27;,\n       &#x27;2018-06-01T10:20:24.000000000&#x27;, &#x27;2018-06-03T10:13:29.000000000&#x27;,\n       &#x27;2018-06-06T10:25:12.000000000&#x27;, &#x27;2018-06-08T10:17:26.000000000&#x27;,\n       &#x27;2018-06-11T10:26:34.000000000&#x27;, &#x27;2018-06-13T10:14:24.000000000&#x27;,\n       &#x27;2018-06-16T10:20:21.000000000&#x27;, &#x27;2018-06-18T10:17:33.000000000&#x27;,\n       &#x27;2018-06-21T10:23:16.000000000&#x27;, &#x27;2018-06-23T10:11:39.000000000&#x27;,\n       &#x27;2018-06-26T10:26:26.000000000&#x27;, &#x27;2018-06-28T10:13:58.000000000&#x27;],\n      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d925dbf4-4b39-4bcf-8bf5-e52f4b0a18bd' class='xr-section-summary-in' type='checkbox'  ><label for='section-d925dbf4-4b39-4bcf-8bf5-e52f4b0a18bd' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e7df0de9-1d27-424f-8cee-d3a9f9eabbfb' class='xr-index-data-in' type='checkbox'/><label for='index-e7df0de9-1d27-424f-8cee-d3a9f9eabbfb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2018-02-01 10:22:37&#x27;, &#x27;2018-02-03 10:12:37&#x27;,\n               &#x27;2018-02-06 10:22:06&#x27;, &#x27;2018-02-08 10:11:53&#x27;,\n               &#x27;2018-02-11 10:25:59&#x27;, &#x27;2018-02-13 10:15:59&#x27;,\n               &#x27;2018-02-16 10:26:01&#x27;, &#x27;2018-02-18 10:13:13&#x27;,\n               &#x27;2018-02-21 10:20:33&#x27;, &#x27;2018-02-23 10:15:08&#x27;,\n               &#x27;2018-02-26 10:20:50&#x27;, &#x27;2018-02-28 10:10:21&#x27;,\n               &#x27;2018-03-03 10:27:07&#x27;, &#x27;2018-03-05 10:13:15&#x27;,\n               &#x27;2018-03-08 10:22:41&#x27;, &#x27;2018-03-10 10:10:20&#x27;,\n               &#x27;2018-03-13 10:25:40&#x27;, &#x27;2018-03-15 10:10:38&#x27;,\n               &#x27;2018-03-20 10:10:21&#x27;, &#x27;2018-03-23 10:20:21&#x27;,\n               &#x27;2018-03-25 10:15:11&#x27;, &#x27;2018-03-28 10:23:58&#x27;,\n               &#x27;2018-03-30 10:16:20&#x27;, &#x27;2018-04-02 10:24:35&#x27;,\n               &#x27;2018-04-04 10:10:21&#x27;, &#x27;2018-04-07 10:20:20&#x27;,\n               &#x27;2018-04-09 10:13:43&#x27;, &#x27;2018-04-12 10:20:24&#x27;,\n               &#x27;2018-04-14 10:15:36&#x27;, &#x27;2018-04-17 10:20:21&#x27;,\n               &#x27;2018-04-19 10:14:57&#x27;, &#x27;2018-04-22 10:21:15&#x27;,\n               &#x27;2018-04-24 10:15:26&#x27;, &#x27;2018-04-27 10:20:22&#x27;,\n               &#x27;2018-04-29 10:12:58&#x27;, &#x27;2018-05-02 10:24:34&#x27;,\n               &#x27;2018-05-04 10:10:23&#x27;, &#x27;2018-05-07 10:26:48&#x27;,\n               &#x27;2018-05-09 10:16:21&#x27;, &#x27;2018-05-12 10:21:48&#x27;,\n               &#x27;2018-05-14 10:10:52&#x27;, &#x27;2018-05-17 10:22:09&#x27;,\n               &#x27;2018-05-19 10:12:07&#x27;, &#x27;2018-05-22 10:20:25&#x27;,\n               &#x27;2018-05-24 10:10:22&#x27;, &#x27;2018-05-29 10:12:25&#x27;,\n               &#x27;2018-06-01 10:20:24&#x27;, &#x27;2018-06-03 10:13:29&#x27;,\n               &#x27;2018-06-06 10:25:12&#x27;, &#x27;2018-06-08 10:17:26&#x27;,\n               &#x27;2018-06-11 10:26:34&#x27;, &#x27;2018-06-13 10:14:24&#x27;,\n               &#x27;2018-06-16 10:20:21&#x27;, &#x27;2018-06-18 10:17:33&#x27;,\n               &#x27;2018-06-21 10:23:16&#x27;, &#x27;2018-06-23 10:11:39&#x27;,\n               &#x27;2018-06-26 10:26:26&#x27;, &#x27;2018-06-28 10:13:58&#x27;],\n              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6c3bcf7d-d5b3-43a7-877c-d0317043ff13' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6c3bcf7d-d5b3-43a7-877c-d0317043ff13' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'time' (time: 58)>\narray(['2018-02-01T10:22:37.000000000', '2018-02-03T10:12:37.000000000',\n       '2018-02-06T10:22:06.000000000', '2018-02-08T10:11:53.000000000',\n       '2018-02-11T10:25:59.000000000', '2018-02-13T10:15:59.000000000',\n       '2018-02-16T10:26:01.000000000', '2018-02-18T10:13:13.000000000',\n       '2018-02-21T10:20:33.000000000', '2018-02-23T10:15:08.000000000',\n       '2018-02-26T10:20:50.000000000', '2018-02-28T10:10:21.000000000',\n       '2018-03-03T10:27:07.000000000', '2018-03-05T10:13:15.000000000',\n       '2018-03-08T10:22:41.000000000', '2018-03-10T10:10:20.000000000',\n       '2018-03-13T10:25:40.000000000', '2018-03-15T10:10:38.000000000',\n       '2018-03-20T10:10:21.000000000', '2018-03-23T10:20:21.000000000',\n       '2018-03-25T10:15:11.000000000', '2018-03-28T10:23:58.000000000',\n       '2018-03-30T10:16:20.000000000', '2018-04-02T10:24:35.000000000',\n       '2018-04-04T10:10:21.000000000', '2018-04-07T10:20:20.000000000',\n       '2018-04-09T10:13:43.000000000', '2018-04-12T10:20:24.000000000',\n       '2018-04-14T10:15:36.000000000', '2018-04-17T10:20:21.000000000',\n       '2018-04-19T10:14:57.000000000', '2018-04-22T10:21:15.000000000',\n       '2018-04-24T10:15:26.000000000', '2018-04-27T10:20:22.000000000',\n       '2018-04-29T10:12:58.000000000', '2018-05-02T10:24:34.000000000',\n       '2018-05-04T10:10:23.000000000', '2018-05-07T10:26:48.000000000',\n       '2018-05-09T10:16:21.000000000', '2018-05-12T10:21:48.000000000',\n       '2018-05-14T10:10:52.000000000', '2018-05-17T10:22:09.000000000',\n       '2018-05-19T10:12:07.000000000', '2018-05-22T10:20:25.000000000',\n       '2018-05-24T10:10:22.000000000', '2018-05-29T10:12:25.000000000',\n       '2018-06-01T10:20:24.000000000', '2018-06-03T10:13:29.000000000',\n       '2018-06-06T10:25:12.000000000', '2018-06-08T10:17:26.000000000',\n       '2018-06-11T10:26:34.000000000', '2018-06-13T10:14:24.000000000',\n       '2018-06-16T10:20:21.000000000', '2018-06-18T10:17:33.000000000',\n       '2018-06-21T10:23:16.000000000', '2018-06-23T10:11:39.000000000',\n       '2018-06-26T10:26:26.000000000', '2018-06-28T10:13:58.000000000'],\n      dtype='datetime64[ns]')\nCoordinates:\n  * time     (time) datetime64[ns] 2018-02-01T10:22:37 ... 2018-06-28T10:13:58\nAttributes:\n    standard_name:  time\n    bounds:         time_bnds","content_type":"text/plain"}}},"children":[],"key":"SWjm1tv1kF"}],"key":"wVBU3DZRuq"}],"key":"zXrSloOHa9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Show a band image for one date","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aEGORTGuhT"}],"key":"Yq0Oc0jpCu"}],"key":"RFylobNaCu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2rgb.B03.sel(time='2018-04-02T10:24:35.000000000')","key":"Y7nLDio64Z"},{"type":"outputs","id":"Lut541jO1OJjA3pGeYsId","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 20px 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: none;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;B03&#x27; (lat: 1864, lon: 2146)&gt;\ndask.array&lt;getitem, shape=(1864, 2146), dtype=float32, chunksize=(932, 1073), chunktype=numpy.ndarray&gt;\nCoordinates:\n  * lat      (lat) float64 46.99 46.99 46.99 46.99 ... 46.65 46.65 46.65 46.65\n  * lon      (lon) float64 11.02 11.02 11.02 11.02 ... 11.41 11.41 11.41 11.41\n    time     datetime64[ns] 2018-04-02T10:24:35\nAttributes:\n    sample_type:   FLOAT32\n    units:         reflectance\n    wavelength:    559.4\n    wavelength_a:  559.8\n    wavelength_b:  559\n    bandwidth:     36.0\n    bandwidth_a:   36\n    bandwidth_b:   36\n    resolution:    10</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'B03'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 1864</li><li><span class='xr-has-index'>lon</span>: 2146</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-3004e86d-d3b6-423b-bad0-41e0243bdc5a' class='xr-array-in' type='checkbox' checked><label for='section-3004e86d-d3b6-423b-bad0-41e0243bdc5a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(932, 1073), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n    <tr>\n        <td>\n            <table style=\"border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <td> </td>\n                        <th> Array </th>\n                        <th> Chunk </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr>\n                        <th> Bytes </th>\n                        <td> 15.26 MiB </td>\n                        <td> 3.81 MiB </td>\n                    </tr>\n                    \n                    <tr>\n                        <th> Shape </th>\n                        <td> (1864, 2146) </td>\n                        <td> (932, 1073) </td>\n                    </tr>\n                    <tr>\n                        <th> Dask graph </th>\n                        <td colspan=\"2\"> 4 chunks in 3 graph layers </td>\n                    </tr>\n                    <tr>\n                        <th> Data type </th>\n                        <td colspan=\"2\"> float32 numpy.ndarray </td>\n                    </tr>\n                </tbody>\n            </table>\n        </td>\n        <td>\n        <svg width=\"170\" height=\"154\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"52\" x2=\"120\" y2=\"52\" />\n  <line x1=\"0\" y1=\"104\" x2=\"120\" y2=\"104\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"104\" style=\"stroke-width:2\" />\n  <line x1=\"60\" y1=\"0\" x2=\"60\" y2=\"104\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"104\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 120.0,0.0 120.0,104.23112767940354 0.0,104.23112767940354\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"60.000000\" y=\"124.231128\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >2146</text>\n  <text x=\"140.000000\" y=\"52.115564\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,140.000000,52.115564)\">1864</text>\n</svg>\n        </td>\n    </tr>\n</table></div></div></li><li class='xr-section-item'><input id='section-c91e1844-f4f8-4741-9b1b-8481cf82a4d9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c91e1844-f4f8-4741-9b1b-8481cf82a4d9' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>46.99 46.99 46.99 ... 46.65 46.65</div><input id='attrs-c637cae0-112e-4de6-9e10-222d6de44222' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c637cae0-112e-4de6-9e10-222d6de44222' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ac8c740c-878a-4a97-9cad-3fcd5d0e48da' class='xr-var-data-in' type='checkbox'><label for='data-ac8c740c-878a-4a97-9cad-3fcd5d0e48da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>decimal_degrees</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([46.989029, 46.988849, 46.988669, ..., 46.654049, 46.653869, 46.653689])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>11.02 11.02 11.02 ... 11.41 11.41</div><input id='attrs-1fbd8c35-9fea-452a-a5c3-b5cd10b6c223' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1fbd8c35-9fea-452a-a5c3-b5cd10b6c223' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-db534e24-f78e-4bd1-bc43-ad1d82a43719' class='xr-var-data-in' type='checkbox'><label for='data-db534e24-f78e-4bd1-bc43-ad1d82a43719' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>decimal_degrees</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([11.020923, 11.021103, 11.021283, ..., 11.406663, 11.406843, 11.407023])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2018-04-02T10:24:35</div><input id='attrs-fac45b95-576c-4937-b83a-e2f477d4641a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fac45b95-576c-4937-b83a-e2f477d4641a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c58fb07a-3e80-4704-b650-4700ba4668ea' class='xr-var-data-in' type='checkbox'><label for='data-c58fb07a-3e80-4704-b650-4700ba4668ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2018-04-02T10:24:35.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5bd88d64-1cfa-4ac7-84bb-326ed6ace877' class='xr-section-summary-in' type='checkbox'  ><label for='section-5bd88d64-1cfa-4ac7-84bb-326ed6ace877' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a976c870-4cbc-4a1a-b7c8-099dc5267a2b' class='xr-index-data-in' type='checkbox'/><label for='index-a976c870-4cbc-4a1a-b7c8-099dc5267a2b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ 46.98902937879777,  46.98884937879777, 46.988669378797766,\n              46.988489378797766, 46.988309378797766, 46.988129378797765,\n              46.987949378797765, 46.987769378797765, 46.987589378797765,\n              46.987409378797764,\n              ...\n               46.65530937879777,  46.65512937879777,  46.65494937879777,\n              46.654769378797766, 46.654589378797766, 46.654409378797766,\n              46.654229378797766, 46.654049378797765, 46.653869378797765,\n              46.653689378797765],\n             dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=1864))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-54922da9-f775-42d0-abf7-3b44659cbb92' class='xr-index-data-in' type='checkbox'/><label for='index-54922da9-f775-42d0-abf7-3b44659cbb92' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([11.020923333333357, 11.021103333333357, 11.021283333333358,\n              11.021463333333358, 11.021643333333357, 11.021823333333357,\n              11.022003333333357, 11.022183333333357, 11.022363333333358,\n              11.022543333333358,\n              ...\n              11.405403333333355, 11.405583333333356, 11.405763333333356,\n              11.405943333333356, 11.406123333333356, 11.406303333333357,\n              11.406483333333355, 11.406663333333356, 11.406843333333356,\n              11.407023333333356],\n             dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=2146))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d9890ba4-9dd9-4c8c-92d2-cd5b250fa29b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d9890ba4-9dd9-4c8c-92d2-cd5b250fa29b' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>sample_type :</span></dt><dd>FLOAT32</dd><dt><span>units :</span></dt><dd>reflectance</dd><dt><span>wavelength :</span></dt><dd>559.4</dd><dt><span>wavelength_a :</span></dt><dd>559.8</dd><dt><span>wavelength_b :</span></dt><dd>559</dd><dt><span>bandwidth :</span></dt><dd>36.0</dd><dt><span>bandwidth_a :</span></dt><dd>36</dd><dt><span>bandwidth_b :</span></dt><dd>36</dd><dt><span>resolution :</span></dt><dd>10</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'B03' (lat: 1864, lon: 2146)>\ndask.array<getitem, shape=(1864, 2146), dtype=float32, chunksize=(932, 1073), chunktype=numpy.ndarray>\nCoordinates:\n  * lat      (lat) float64 46.99 46.99 46.99 46.99 ... 46.65 46.65 46.65 46.65\n  * lon      (lon) float64 11.02 11.02 11.02 11.02 ... 11.41 11.41 11.41 11.41\n    time     datetime64[ns] 2018-04-02T10:24:35\nAttributes:\n    sample_type:   FLOAT32\n    units:         reflectance\n    wavelength:    559.4\n    wavelength_a:  559.8\n    wavelength_b:  559\n    bandwidth:     36.0\n    bandwidth_a:   36\n    bandwidth_b:   36\n    resolution:    10","content_type":"text/plain"}}},"children":[],"key":"qXlfIdKCab"}],"key":"OAmXius2aQ"}],"key":"wv3ujIwso5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2rgb.B03.sel(time='2018-04-02T10:24:35.000000000').plot.imshow(vmin=0, vmax=0.5, cmap='gray')","key":"AaCHuOjgya"},{"type":"outputs","id":"hRQELQqrG1gbaVYbPx3xD","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ffa8a79cca96e9a41a673a384ad7031d","path":"/cubes-and-clouds/build/ffa8a79cca96e9a41a673a384ad7031d.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"xOz2bNoDuB"}],"key":"Xpob4HPiIm"}],"key":"NJ4nwOQTnR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Show the RGB image for the same date","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VtxJw6fCcK"}],"key":"E7gixVDAXU"}],"key":"pjzBHGaYLU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2rgb[['B04', 'B03', 'B02']].sel(time='2018-04-02T10:24:35.000000000').to_array().plot.imshow(vmin=0, vmax=0.3)","key":"wI8sXHTY04"},{"type":"outputs","id":"cP5WSTNYKHiActkN0Vf7U","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0ed9d3d758b2a282ed6310a3b7e7daeb","path":"/cubes-and-clouds/build/0ed9d3d758b2a282ed6310a3b7e7daeb.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"iW2ZhYVDG3"}],"key":"KBSC26Lgz7"}],"key":"MpQNEjkkBk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Show the cloud mask for the same date","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X9tQN8UOaX"}],"key":"XKR0ARD81Z"}],"key":"dESmA8Ijcf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2rgb.CLM.sel(time='2018-04-02T10:24:35.000000000').plot.imshow()","key":"qkWUzIgTni"},{"type":"outputs","id":"FQ9Ekx-AIxSfVMZWvxbbz","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"590ca92671487559b3407f32671dfbe1","path":"/cubes-and-clouds/build/590ca92671487559b3407f32671dfbe1.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"i6yEFU1g09"}],"key":"RXofa4pgcX"}],"key":"ORdL7fwF22"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Show a pixel time series for one band","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NfhQfhbfD0"}],"key":"DMBrMUPqS9"}],"key":"TO8hFSBvPa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2rgb.B03.sel(lat=46.8, lon=11.2, method='nearest').plot()","key":"T5wT5LjW5i"},{"type":"outputs","id":"ZMnI3tn7eQ9rLUFRaqfJP","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0b096c6946f965855168cabbf0baa361","path":"/cubes-and-clouds/build/0b096c6946f965855168cabbf0baa361.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"i4fxlitAdh"}],"key":"GTEov0dPVX"}],"key":"Bh9YD5mCk0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create the snowmap data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OOd0U1XhNe"}],"identifier":"create-the-snowmap-data-cube","label":"Create the snowmap data cube","html_id":"create-the-snowmap-data-cube","implicit":true,"key":"tjaoIVihvl"}],"key":"Hcmhw1iNnt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After cloud masking, snow map can be obtained by thresholding the Normalized Difference Snow Index (NDSI) which is computed as:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EHtRZXSgMF"}],"key":"uBMYSlvm75"},{"type":"math","value":"NDSI = \\frac {GREEN - SWIR} {GREEN +SWIR}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>N</mi><mi>D</mi><mi>S</mi><mi>I</mi><mo>=</mo><mfrac><mrow><mi>G</mi><mi>R</mi><mi>E</mi><mi>E</mi><mi>N</mi><mo>−</mo><mi>S</mi><mi>W</mi><mi>I</mi><mi>R</mi></mrow><mrow><mi>G</mi><mi>R</mi><mi>E</mi><mi>E</mi><mi>N</mi><mo>+</mo><mi>S</mi><mi>W</mi><mi>I</mi><mi>R</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">NDSI = \\frac {GREEN - SWIR} {GREEN +SWIR}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1297em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">GREEN</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">GREEN</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"CbNGJoRw9y"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will therefore create a Sentinel-2 data cube with bands B03 (green), B11 (SWIR) and the cloud mask (CLM). To speed up the computation of the SCA we will set the resolution equal to 0.0018 degrees, which correspond roughly to 100 m. This resolution is generally enough to get reliable estimate of snow cover area over a catchment.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UvYfDjVhTk"}],"key":"CEiBDOaZGk"}],"key":"s4vPSKBcLK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_config_s2snowmap = CubeConfig(\n    dataset_name='S2L2A',\n    band_names=['B03', 'B11', 'CLM'],\n    bbox=bbox.tolist(),\n    spatial_res=0.0018,\n    time_range=[start_date.strftime(\"%Y-%m-%d\"), end_date.strftime(\"%Y-%m-%d\")],\n    downsampling='BILINEAR'\n)","key":"TIZjUGe6T5"},{"type":"outputs","id":"Y9TqqCYnNr8oRzX2jG2hB","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/conda/master-asi-conae/315434deb1b1e05eacacc41e1b0529b1837100f46402a32041d77ba54ae6c5f3-20230213-125825-013239-74-edc-2022.10-14/lib/python3.9/site-packages/xcube_sh/config.py:248: FutureWarning: Units 'M', 'Y' and 'y' do not represent unambiguous timedelta values and will be removed in a future version.\n  time_tolerance = pd.to_timedelta(time_tolerance)\n"},"children":[],"key":"R2ypKtlB93"}],"key":"QL55Qa563l"}],"key":"Gv2MstzICq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap = open_cube(cube_config_s2snowmap)\ncube_s2snowmap","key":"GgCwDqb4yM"},{"type":"outputs","id":"v1u7sDO8ZZdfPxxzmj5YC","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"254f19272089c36188214431ab0e8d5f","path":"/cubes-and-clouds/build/254f19272089c36188214431ab0e8d5f.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:    (time: 58, lat: 167, lon: 192, bnds: 2)\nCoordinates:\n  * lat        (lat) float64 46.95 46.95 46.95 46.95 ... 46.66 46.66 46.66 46.65\n  * lon        (lon) float64 11.02 11.02 11.03 11.03 ... 11.36 11.36 11.36 11.37\n  * time       (time) datetime64[ns] 2018-02-01T10:22:37 ... 2018-06-28T10:13:58\n    time_bnds  (time, bnds) datetime64[ns] dask.array<chunksize=(58, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B03        (time, lat, lon) float32 dask.array<chunksize=(1, 167, 192), meta=np.ndarray>\n    B11        (time, lat, lon) float32 dask.array<chunksize=(1, 167, 192), meta=np.ndarray>\n    CLM        (time, lat, lon) float32 dask.array<chunksize=(1, 167, 192), meta=np.ndarray>\nAttributes:\n    Conventions:             CF-1.7\n    title:                   S2L2A Data Cube Subset\n    history:                 [{'program': 'xcube_sh.chunkstore.SentinelHubChu...\n    date_created:            2023-02-17T09:42:47.174581\n    time_coverage_start:     2018-02-01T10:22:37+00:00\n    time_coverage_end:       2018-06-28T10:13:58+00:00\n    time_coverage_duration:  P146DT23H51M21S\n    geospatial_lon_min:      11.020833333333357\n    geospatial_lat_min:      46.653599378797765\n    geospatial_lon_max:      11.366433333333356\n    geospatial_lat_max:      46.95419937879777\n    processing_level:        L2A","content_type":"text/plain"}}},"children":[],"key":"qGO0B2cZBM"}],"key":"Z2VZlh7QEJ"}],"key":"RkigyArNTc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compute the NDSI and add it to the cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D1TzLhDvHY"}],"key":"VsHH6MfdV9"}],"key":"WCoXImuhWI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ndsi=(cube_s2snowmap.B03 - cube_s2snowmap.B11) / (cube_s2snowmap.B03 + cube_s2snowmap.B11)\n\nndsi.attrs['long_name']='Normalized Difference Snow Index'\nndsi.attrs['units']='unitless'\n\ncube_s2snowmap['NDSI']=ndsi","key":"h26ZSkYu5A"},{"type":"outputs","id":"A-F9MeZD_7PLHWm299yh-","children":[],"key":"bWhVuSKf2e"}],"key":"WLZ6clFUVV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize an NDSI image for a specific date","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uJM7FK6EKM"}],"key":"ZDlGNQl2sq"}],"key":"csgxpi978a"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap.NDSI.sel(time='2018-04-02T10:24:35.000000000').plot.imshow(vmin=-1, vmax=1, cmap='gray')","visibility":"show","key":"Px0SBtcFxL"},{"type":"outputs","id":"FaysIyusAbxD78a3NQtwS","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"279d8b8ae7ee7d04ce2d8a1ada7b138e","path":"/cubes-and-clouds/build/279d8b8ae7ee7d04ce2d8a1ada7b138e.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"SSw3cOhqyE"}],"visibility":"show","key":"RncoT394zR"}],"visibility":"show","key":"XzejOYoDZ5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create the snow cover maps by setting a threshold equal to 0.4 on the NDSI","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dez6R879Ca"}],"key":"k1BcdY8E0w"}],"key":"FciiCy4G2p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":" cube_s2snowmap['snowmap'] = cube_s2snowmap.NDSI > 0.4","key":"kbGWQv5oOv"},{"type":"outputs","id":"tH14kBxHE3SSpZez9zIzW","children":[],"key":"VF9v6l9g6d"}],"key":"TVCVj3fr7f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap","key":"vyMbH9AGvv"},{"type":"outputs","id":"KW8wxFDQmTa2u9r-OTUvV","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"d84df8d6a31d3c960443d2da4a800fbf","path":"/cubes-and-clouds/build/d84df8d6a31d3c960443d2da4a800fbf.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:    (time: 58, lat: 167, lon: 192, bnds: 2)\nCoordinates:\n  * lat        (lat) float64 46.95 46.95 46.95 46.95 ... 46.66 46.66 46.66 46.65\n  * lon        (lon) float64 11.02 11.02 11.03 11.03 ... 11.36 11.36 11.36 11.37\n  * time       (time) datetime64[ns] 2018-02-01T10:22:37 ... 2018-06-28T10:13:58\n    time_bnds  (time, bnds) datetime64[ns] dask.array<chunksize=(58, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B03        (time, lat, lon) float32 dask.array<chunksize=(1, 167, 192), meta=np.ndarray>\n    B11        (time, lat, lon) float32 dask.array<chunksize=(1, 167, 192), meta=np.ndarray>\n    CLM        (time, lat, lon) float32 dask.array<chunksize=(1, 167, 192), meta=np.ndarray>\n    NDSI       (time, lat, lon) float32 dask.array<chunksize=(1, 167, 192), meta=np.ndarray>\n    snowmap    (time, lat, lon) bool dask.array<chunksize=(1, 167, 192), meta=np.ndarray>\nAttributes:\n    Conventions:             CF-1.7\n    title:                   S2L2A Data Cube Subset\n    history:                 [{'program': 'xcube_sh.chunkstore.SentinelHubChu...\n    date_created:            2023-02-17T09:42:47.174581\n    time_coverage_start:     2018-02-01T10:22:37+00:00\n    time_coverage_end:       2018-06-28T10:13:58+00:00\n    time_coverage_duration:  P146DT23H51M21S\n    geospatial_lon_min:      11.020833333333357\n    geospatial_lat_min:      46.653599378797765\n    geospatial_lon_max:      11.366433333333356\n    geospatial_lat_max:      46.95419937879777\n    processing_level:        L2A","content_type":"text/plain"}}},"children":[],"key":"Y7ySXrCVWz"}],"key":"JQAcSl62q9"}],"key":"rVn2SEgz3s"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add the cloud mask","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Efxobzqyno"}],"key":"B7rNyKjCIM"}],"key":"FEODtE83TR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap['snowmap'] = cube_s2snowmap.snowmap.where(cube_s2snowmap.CLM==0) ","key":"F7wLoFgpLg"},{"type":"outputs","id":"iP8mxDUQc8qvrBrYAGrO0","children":[],"key":"eNvuNF9NsM"}],"key":"TGqHOqxTpz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Show a snow map (no snow = 0, snow = 1, cloud = NaN)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SndOdhrCpw"}],"key":"OTwoUoj3MJ"}],"key":"wIlYhxnC6z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap.snowmap.sel(time='2018-04-02T10:24:35.000000000').plot.imshow()","key":"N0c4HsA8mw"},{"type":"outputs","id":"eTG1Mj-02g9aYWrfjTqsw","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"97095abd4685fe6634ad10dc1adf3837","path":"/cubes-and-clouds/build/97095abd4685fe6634ad10dc1adf3837.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"VORdAYWjBF"}],"key":"XN7oK2o5rU"}],"key":"fYTX86OK8g"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Catchment SCA time series","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uRrGQOsYpW"}],"identifier":"catchment-sca-time-series","label":"Catchment SCA time series","html_id":"catchment-sca-time-series","implicit":true,"key":"mLWI2yLT6u"}],"key":"Ecq3frUZy2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Mask with the catchment outline","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WB2n7VdPwX"}],"key":"V9L1a6gql1"}],"key":"QnSr91HAp8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap_masked = mask_dataset_by_geometry(cube_s2snowmap, catchment_outline.iloc[0].geometry)","key":"TMVGPW6ZhS"},{"type":"outputs","id":"5chO6tkXZwmxj0TiWAL0w","children":[],"key":"xkfxMoh8sQ"}],"key":"wuymQh1O86"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap_masked.snowmap.sel(time='2018-04-02T10:24:35.000000000').plot.imshow()","key":"KFBimn6vbt"},{"type":"outputs","id":"68ZV6igPjuIVGKutbvk2u","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fdf539e6af5c9f4b4db6acfcb94e8f40","path":"/cubes-and-clouds/build/fdf539e6af5c9f4b4db6acfcb94e8f40.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"ajC1KhWhmp"}],"key":"NlQsjwpqEw"}],"key":"fbSZaEIzt2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compute the cloud percent in the catchment for each Sentinel-2 image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kpcqm8hbw8"}],"key":"ySOLkiDG7K"}],"key":"xrJCVXW4CH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n_cloud = cube_s2snowmap_masked.CLM.sum(dim=['lat', 'lon'])\nn_cloud_valid = cube_s2snowmap_masked.CLM.count(dim=['lat', 'lon'])\n\ncube_s2snowmap_masked['cloud_percent'] = n_cloud / n_cloud_valid * 100\ncube_s2snowmap_masked","key":"jQJPDewxEl"},{"type":"outputs","id":"6HlybeAzz8EZt_LCcSxLF","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"e7da182cc8a4635a51fcace9f002a0de","path":"/cubes-and-clouds/build/e7da182cc8a4635a51fcace9f002a0de.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:        (lat: 166, lon: 191, time: 58, bnds: 2)\nCoordinates:\n  * lat            (lat) float64 46.95 46.95 46.95 46.95 ... 46.66 46.66 46.66\n  * lon            (lon) float64 11.02 11.02 11.03 11.03 ... 11.36 11.36 11.36\n  * time           (time) datetime64[ns] 2018-02-01T10:22:37 ... 2018-06-28T1...\n    time_bnds      (time, bnds) datetime64[ns] dask.array<chunksize=(58, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B03            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    B11            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    CLM            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    NDSI           (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    snowmap        (time, lat, lon) float64 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    cloud_percent  (time) float64 dask.array<chunksize=(1,), meta=np.ndarray>\nAttributes: (12/17)\n    Conventions:                CF-1.7\n    title:                      S2L2A Data Cube Subset\n    history:                    [{'program': 'xcube_sh.chunkstore.SentinelHub...\n    date_created:               2023-02-17T09:42:47.174581\n    time_coverage_start:        2018-02-01T10:22:37+00:00\n    time_coverage_end:          2018-06-28T10:13:58+00:00\n    ...                         ...\n    processing_level:           L2A\n    geospatial_lon_units:       degrees_east\n    geospatial_lon_resolution:  0.0018000000000000028\n    geospatial_lat_units:       degrees_north\n    geospatial_lat_resolution:  0.0017999999999999822\n    date_modified:              2023-02-17T09:43:16.744018","content_type":"text/plain"}}},"children":[],"key":"PmTpf4V7dV"}],"key":"Bfk8ZZgFaV"}],"key":"EGJictlCgZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In order to get an accurate snow cover area estimation we want to keep only the Sentinel-2 images with a cloud percent in the catchment lower than 20%","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bFldrRO9dn"}],"key":"bJ2b2WJv9l"}],"key":"XupYQpGOxK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap_masked = cube_s2snowmap_masked.sel(time=cube_s2snowmap_masked.cloud_percent < 20)","key":"SimP4fC1Ho"},{"type":"outputs","id":"x6_zVpVWzY2eyOW9Lti9P","children":[],"key":"giu6ETzjyX"}],"key":"xTuO7eD9Sr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For the remaining image we can then estimate the snow cover area","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UQrC6jNNHU"}],"key":"uzutPg246x"}],"key":"cRBngLAREv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n_snow = cube_s2snowmap_masked.snowmap.sum(dim=['lat', 'lon'])\nn_snow_valid = cube_s2snowmap_masked.snowmap.count(dim=['lat', 'lon'])\n\ncube_s2snowmap_masked['snow_percent'] = n_snow / n_snow_valid * 100","key":"V0opPyx0B6"},{"type":"outputs","id":"zfBeczSWHxHDY9ncyKRDl","children":[],"key":"SrFJkERQcw"}],"key":"rDQYgRfrD1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The snow and cloud percentage value can be represented in a pandas DataFrame and saved as csv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GvASmXrOPL"}],"key":"ZHXrsEbomq"}],"key":"kx9WeXuUlE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sca_ts = cube_s2snowmap_masked[['cloud_percent', 'snow_percent']].to_dataframe()\nsca_ts","key":"x1D9DqMIam"},{"type":"outputs","id":"gNPWMIPbo-7qtIRS3ByKk","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>cloud_percent</th>\n      <th>snow_percent</th>\n    </tr>\n    <tr>\n      <th>time</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2018-02-08 10:11:53</th>\n      <td>14.107938</td>\n      <td>79.586701</td>\n    </tr>\n    <tr>\n      <th>2018-02-11 10:25:59</th>\n      <td>4.827089</td>\n      <td>74.475260</td>\n    </tr>\n    <tr>\n      <th>2018-02-13 10:15:59</th>\n      <td>18.384857</td>\n      <td>68.060348</td>\n    </tr>\n    <tr>\n      <th>2018-02-21 10:20:33</th>\n      <td>0.000000</td>\n      <td>71.934766</td>\n    </tr>\n    <tr>\n      <th>2018-02-28 10:10:21</th>\n      <td>12.765261</td>\n      <td>68.030633</td>\n    </tr>\n    <tr>\n      <th>2018-03-08 10:22:41</th>\n      <td>10.734870</td>\n      <td>85.508841</td>\n    </tr>\n    <tr>\n      <th>2018-03-20 10:10:21</th>\n      <td>11.095101</td>\n      <td>78.134669</td>\n    </tr>\n    <tr>\n      <th>2018-03-23 10:20:21</th>\n      <td>14.219282</td>\n      <td>69.458655</td>\n    </tr>\n    <tr>\n      <th>2018-03-25 10:15:11</th>\n      <td>4.466859</td>\n      <td>69.813520</td>\n    </tr>\n    <tr>\n      <th>2018-04-02 10:24:35</th>\n      <td>4.460309</td>\n      <td>68.725578</td>\n    </tr>\n    <tr>\n      <th>2018-04-07 10:20:20</th>\n      <td>0.700812</td>\n      <td>66.367654</td>\n    </tr>\n    <tr>\n      <th>2018-04-14 10:15:36</th>\n      <td>10.178150</td>\n      <td>72.582762</td>\n    </tr>\n    <tr>\n      <th>2018-04-19 10:14:57</th>\n      <td>0.000000</td>\n      <td>58.560388</td>\n    </tr>\n    <tr>\n      <th>2018-04-22 10:21:15</th>\n      <td>0.000000</td>\n      <td>54.872937</td>\n    </tr>\n    <tr>\n      <th>2018-04-24 10:15:26</th>\n      <td>18.273513</td>\n      <td>49.479083</td>\n    </tr>\n    <tr>\n      <th>2018-06-16 10:20:21</th>\n      <td>0.137543</td>\n      <td>6.388142</td>\n    </tr>\n    <tr>\n      <th>2018-06-23 10:11:39</th>\n      <td>3.163479</td>\n      <td>3.645587</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"                     cloud_percent  snow_percent\ntime                                            \n2018-02-08 10:11:53      14.107938     79.586701\n2018-02-11 10:25:59       4.827089     74.475260\n2018-02-13 10:15:59      18.384857     68.060348\n2018-02-21 10:20:33       0.000000     71.934766\n2018-02-28 10:10:21      12.765261     68.030633\n2018-03-08 10:22:41      10.734870     85.508841\n2018-03-20 10:10:21      11.095101     78.134669\n2018-03-23 10:20:21      14.219282     69.458655\n2018-03-25 10:15:11       4.466859     69.813520\n2018-04-02 10:24:35       4.460309     68.725578\n2018-04-07 10:20:20       0.700812     66.367654\n2018-04-14 10:15:36      10.178150     72.582762\n2018-04-19 10:14:57       0.000000     58.560388\n2018-04-22 10:21:15       0.000000     54.872937\n2018-04-24 10:15:26      18.273513     49.479083\n2018-06-16 10:20:21       0.137543      6.388142\n2018-06-23 10:11:39       3.163479      3.645587","content_type":"text/plain"}}},"children":[],"key":"R253ljuR3T"}],"key":"d048CFFw3g"}],"key":"x1YouSBaP8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sca_ts['snow_percent'].to_csv('s2_sca_ts_cloudfree.csv')","key":"eECSTtQsM6"},{"type":"outputs","id":"IoB3Qmj6QnhNP6ufZrrpg","children":[],"key":"uMER0VXGRL"}],"key":"qB0GfQue01"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sca_ts['snow_percent'].plot(marker='o')","key":"pqHO4A2TDC"},{"type":"outputs","id":"f90fqKv-xutWXCudOUxzx","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b22ecfa29db4f7b0a6e4cdb7d485d82a","path":"/cubes-and-clouds/build/b22ecfa29db4f7b0a6e4cdb7d485d82a.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"XH5IXePI7c"}],"key":"dRwSUXV8Ds"}],"key":"dwK1dwgws9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare the evolution of SCA to runoff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I0NlgBz6Oy"}],"identifier":"compare-the-evolution-of-sca-to-runoff","label":"Compare the evolution of SCA to runoff","html_id":"compare-the-evolution-of-sca-to-runoff","implicit":true,"key":"Qk8ln8dYVH"}],"key":"GWhSVaBJEN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In alpine catchment snow represent a major contribution to the runoff during the melting season. As a qualitative analysis we will plot the runoff time series for the selected catchment toghether with the SCA time series we derived from Sentinel-2. As soon as the SCA decreases due to melting, the snow melt contribution implies an increase of the runoff.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PWtVZmRUT2"}],"key":"j3EwLSnPjf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Load the runoff time series stored in the csv file:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Jw75PvF6uE"}],"key":"sn1YWkCeh2"}],"key":"kGmEmSsEIW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dsc = pd.read_csv('ADO_DSC_ITH1_0025.csv', sep=',', index_col='Time', parse_dates=True)","key":"nnUobZGJL1"},{"type":"outputs","id":"9K4oxogI7Hi3l40Jj9q5v","children":[],"key":"P7JEwzm63g"}],"key":"LXJu38is0U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dsc","key":"vXqeplqfbK"},{"type":"outputs","id":"WtNiWuDsLccHlLUtukWr3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>discharge_m3_s</th>\n    </tr>\n    <tr>\n      <th>Time</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1994-01-01 01:00:00</th>\n      <td>4.03</td>\n    </tr>\n    <tr>\n      <th>1994-01-02 01:00:00</th>\n      <td>3.84</td>\n    </tr>\n    <tr>\n      <th>1994-01-03 01:00:00</th>\n      <td>3.74</td>\n    </tr>\n    <tr>\n      <th>1994-01-04 01:00:00</th>\n      <td>3.89</td>\n    </tr>\n    <tr>\n      <th>1994-01-05 01:00:00</th>\n      <td>3.80</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>2021-07-17 02:00:00</th>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2021-07-18 02:00:00</th>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2021-07-19 02:00:00</th>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2021-07-20 02:00:00</th>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2021-07-21 02:00:00</th>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>10064 rows × 1 columns</p>\n</div>","content_type":"text/html"},"text/plain":{"content":"                     discharge_m3_s\nTime                               \n1994-01-01 01:00:00            4.03\n1994-01-02 01:00:00            3.84\n1994-01-03 01:00:00            3.74\n1994-01-04 01:00:00            3.89\n1994-01-05 01:00:00            3.80\n...                             ...\n2021-07-17 02:00:00             NaN\n2021-07-18 02:00:00             NaN\n2021-07-19 02:00:00             NaN\n2021-07-20 02:00:00             NaN\n2021-07-21 02:00:00             NaN\n\n[10064 rows x 1 columns]","content_type":"text/plain"}}},"children":[],"key":"ri2JELbHkJ"}],"key":"DMWhfQj1TJ"}],"key":"NFUwVzmHzL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select the runoff time series accordingly with the time period we used to estimate the Sentinel-2 SCA","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ztkYiL7dmm"}],"key":"TUnkRcn0cT"}],"key":"XARyxSn9v7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dsc = dsc.loc[start_date:end_date]\ndsc.plot()","key":"vOz6nzeeyP"},{"type":"outputs","id":"blWXj5tgYDlJFYGE2P7Xs","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0fea4cb7941ca5ff67f25e18df0efb12","path":"/cubes-and-clouds/build/0fea4cb7941ca5ff67f25e18df0efb12.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"zw1KxJRgLB"}],"key":"Iw7Ae6EfkN"}],"key":"zvjpx8QOGX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the runoff (left axes, blue line) toghether with the Sentinel-2 SCA (right axes, orange line)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aATgNqFcQZ"}],"key":"ZWVROJCtHc"}],"key":"IijArUs9wj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ax1 = dsc.discharge_m3_s.plot(label='Discharge', xlabel='', ylabel='Discharge (m$^3$/s)')\nax2 = sca_ts.snow_percent.plot(marker='o', secondary_y=True, label='SCA', xlabel='', ylabel='Snow cover area (%)')\n\nax1.legend(loc='center left', bbox_to_anchor=(0, 0.6))\nax2.legend(loc='center left', bbox_to_anchor=(0, 0.5))\n\nplt.show()","key":"ZGA3WRRfvO"},{"type":"outputs","id":"2otvOET-hqSQz8v0zYWS0","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"71fe6288debc9272e7f374a231b989de","path":"/cubes-and-clouds/build/71fe6288debc9272e7f374a231b989de.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"AIdgI3PG0S"}],"key":"q6gS589EVl"}],"key":"xOkJnl568N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"UbKJn76Ldz"},{"type":"outputs","id":"9E7Sigt5NXJVf8pYlAqaJ","children":[],"key":"budeH8h6Jy"}],"key":"ndTgtNtfJX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"fYf2sBuhrw"},{"type":"outputs","id":"IrGfWpXWSdWSS_wEoIBdK","children":[],"key":"XB2so4KbwH"}],"key":"WVbnewQqc1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"DnhPp1SzWD"},{"type":"outputs","id":"Fdq6cu_efY_wRgASzW2SY","children":[],"key":"DoTzqsSbsB"}],"key":"VbrH3zql8r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"OZufRptycS"},{"type":"outputs","id":"FbaLD02lwoYlIBoPZ7CNN","children":[],"key":"kAf6RjgO5U"}],"key":"yaLolgZAq6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"ipQCZ1hkGC"},{"type":"outputs","id":"eBm-G-3Dqh6ZNi1ePl5Me","children":[],"key":"Uf34kjILMD"}],"key":"IkUqDywcD7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap['snowmap'] = cube_s2snowmap.snowmap.where(cube_s2snowmap.CLM==0, 2) ","key":"uuQ5ZYiwR4"},{"type":"outputs","id":"ib_1JhVPZWRPT84SxP_aV","children":[],"key":"yGX7BTYhRc"}],"key":"Bb8CLpPq7V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap.snowmap.sel(time='2018-04-02T10:24:35.000000000').plot.imshow()","key":"IbYDYjj2OV"},{"type":"outputs","id":"vr2xVT5jKKanmWoKJePd2","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"95f5fbc8ab4d6c15184a5cbf45dfa301","path":"/cubes-and-clouds/build/95f5fbc8ab4d6c15184a5cbf45dfa301.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"s91KISlhji"}],"key":"L5VTjlBN68"}],"key":"X4QSboSgqJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap_masked = mask_dataset_by_geometry(cube_s2snowmap, catchment_outline.iloc[0].geometry, save_geometry_mask=True)\ncube_s2snowmap_masked","key":"ONHsG5eNs6"},{"type":"outputs","id":"rX-bIi3neBmSXX_SoQpIY","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"b59183cb88c7759dd801f0a22cf672a5","path":"/cubes-and-clouds/build/b59183cb88c7759dd801f0a22cf672a5.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:        (lat: 166, lon: 191, time: 58, bnds: 2)\nCoordinates:\n  * lat            (lat) float64 46.95 46.95 46.95 46.95 ... 46.66 46.66 46.66\n  * lon            (lon) float64 11.02 11.02 11.03 11.03 ... 11.36 11.36 11.36\n  * time           (time) datetime64[ns] 2018-02-01T10:22:37 ... 2018-06-28T1...\n    time_bnds      (time, bnds) datetime64[ns] dask.array<chunksize=(58, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B03            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    B11            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    CLM            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    NDSI           (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    snowmap        (time, lat, lon) float64 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    geometry_mask  (lat, lon) bool dask.array<chunksize=(166, 191), meta=np.ndarray>\nAttributes: (12/17)\n    Conventions:                CF-1.7\n    title:                      S2L2A Data Cube Subset\n    history:                    [{'program': 'xcube_sh.chunkstore.SentinelHub...\n    date_created:               2023-02-17T09:40:08.516335\n    time_coverage_start:        2018-02-01T10:22:37+00:00\n    time_coverage_end:          2018-06-28T10:13:58+00:00\n    ...                         ...\n    processing_level:           L2A\n    geospatial_lon_units:       degrees_east\n    geospatial_lon_resolution:  0.0018000000000000028\n    geospatial_lat_units:       degrees_north\n    geospatial_lat_resolution:  0.0017999999999999822\n    date_modified:              2023-02-17T09:40:51.289454","content_type":"text/plain"}}},"children":[],"key":"Sl3Cbr3aqW"}],"key":"CzruFQ8g83"}],"key":"h5g8Ih2v3M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap_masked['CLM'] = cube_s2snowmap_masked.CLM == 1\ncube_s2snowmap_masked","key":"MmB1qRr7Ix"},{"type":"outputs","id":"DLWiHmrWX9JmoGJENDh3h","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"da303fd4eb4bba0a342560d5ad18e27e","path":"/cubes-and-clouds/build/da303fd4eb4bba0a342560d5ad18e27e.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:        (lat: 166, lon: 191, time: 58, bnds: 2)\nCoordinates:\n  * lat            (lat) float64 46.95 46.95 46.95 46.95 ... 46.66 46.66 46.66\n  * lon            (lon) float64 11.02 11.02 11.03 11.03 ... 11.36 11.36 11.36\n  * time           (time) datetime64[ns] 2018-02-01T10:22:37 ... 2018-06-28T1...\n    time_bnds      (time, bnds) datetime64[ns] dask.array<chunksize=(58, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B03            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    B11            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    CLM            (time, lat, lon) bool dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    NDSI           (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    snowmap        (time, lat, lon) float64 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    geometry_mask  (lat, lon) bool dask.array<chunksize=(166, 191), meta=np.ndarray>\nAttributes: (12/17)\n    Conventions:                CF-1.7\n    title:                      S2L2A Data Cube Subset\n    history:                    [{'program': 'xcube_sh.chunkstore.SentinelHub...\n    date_created:               2023-02-17T09:40:08.516335\n    time_coverage_start:        2018-02-01T10:22:37+00:00\n    time_coverage_end:          2018-06-28T10:13:58+00:00\n    ...                         ...\n    processing_level:           L2A\n    geospatial_lon_units:       degrees_east\n    geospatial_lon_resolution:  0.0018000000000000028\n    geospatial_lat_units:       degrees_north\n    geospatial_lat_resolution:  0.0017999999999999822\n    date_modified:              2023-02-17T09:40:51.289454","content_type":"text/plain"}}},"children":[],"key":"Qk3g9wam9Q"}],"key":"vf9F7PKlG9"}],"key":"cSL0e6N2MC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n_cloud = cube_s2snowmap_masked.CLM.sum(dim=['lat', 'lon'])\nn_valid = cube_s2snowmap_masked.geometry_mask.sum(dim=['lat', 'lon'])\n\ncube_s2snowmap_masked['cloud_percent'] = n_cloud / n_valid * 100\ncube_s2snowmap_masked","key":"Fg76MT6p4J"},{"type":"outputs","id":"q0j4vZun2gGmMiy2gOLJ0","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"5bc96caa370753945d42b1e5a4850d31","path":"/cubes-and-clouds/build/5bc96caa370753945d42b1e5a4850d31.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:        (lat: 166, lon: 191, time: 58, bnds: 2)\nCoordinates:\n  * lat            (lat) float64 46.95 46.95 46.95 46.95 ... 46.66 46.66 46.66\n  * lon            (lon) float64 11.02 11.02 11.03 11.03 ... 11.36 11.36 11.36\n  * time           (time) datetime64[ns] 2018-02-01T10:22:37 ... 2018-06-28T1...\n    time_bnds      (time, bnds) datetime64[ns] dask.array<chunksize=(58, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B03            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    B11            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    CLM            (time, lat, lon) bool dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    NDSI           (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    snowmap        (time, lat, lon) float64 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    geometry_mask  (lat, lon) bool dask.array<chunksize=(166, 191), meta=np.ndarray>\n    cloud_percent  (time) float64 dask.array<chunksize=(1,), meta=np.ndarray>\nAttributes: (12/17)\n    Conventions:                CF-1.7\n    title:                      S2L2A Data Cube Subset\n    history:                    [{'program': 'xcube_sh.chunkstore.SentinelHub...\n    date_created:               2023-02-17T09:40:08.516335\n    time_coverage_start:        2018-02-01T10:22:37+00:00\n    time_coverage_end:          2018-06-28T10:13:58+00:00\n    ...                         ...\n    processing_level:           L2A\n    geospatial_lon_units:       degrees_east\n    geospatial_lon_resolution:  0.0018000000000000028\n    geospatial_lat_units:       degrees_north\n    geospatial_lat_resolution:  0.0017999999999999822\n    date_modified:              2023-02-17T09:40:51.289454","content_type":"text/plain"}}},"children":[],"key":"F4c3FDRGrp"}],"key":"LczB6boUFG"}],"key":"ZYZnXJfGpu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap_masked = cube_s2snowmap_masked.sel(time=cube_s2snowmap_masked.cloud_percent < 20)\ncube_s2snowmap_masked","key":"HhlMNLychU"},{"type":"outputs","id":"MIP5V1MgkhAcC6ypfLO_G","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"508d40d6af7e134daebce73b57f5bec0","path":"/cubes-and-clouds/build/508d40d6af7e134daebce73b57f5bec0.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:        (lat: 166, lon: 191, time: 17, bnds: 2)\nCoordinates:\n  * lat            (lat) float64 46.95 46.95 46.95 46.95 ... 46.66 46.66 46.66\n  * lon            (lon) float64 11.02 11.02 11.03 11.03 ... 11.36 11.36 11.36\n  * time           (time) datetime64[ns] 2018-02-08T10:11:53 ... 2018-06-23T1...\n    time_bnds      (time, bnds) datetime64[ns] dask.array<chunksize=(17, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B03            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    B11            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    CLM            (time, lat, lon) bool dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    NDSI           (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    snowmap        (time, lat, lon) float64 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    geometry_mask  (lat, lon) bool dask.array<chunksize=(166, 191), meta=np.ndarray>\n    cloud_percent  (time) float64 dask.array<chunksize=(1,), meta=np.ndarray>\nAttributes: (12/17)\n    Conventions:                CF-1.7\n    title:                      S2L2A Data Cube Subset\n    history:                    [{'program': 'xcube_sh.chunkstore.SentinelHub...\n    date_created:               2023-02-17T09:40:08.516335\n    time_coverage_start:        2018-02-01T10:22:37+00:00\n    time_coverage_end:          2018-06-28T10:13:58+00:00\n    ...                         ...\n    processing_level:           L2A\n    geospatial_lon_units:       degrees_east\n    geospatial_lon_resolution:  0.0018000000000000028\n    geospatial_lat_units:       degrees_north\n    geospatial_lat_resolution:  0.0017999999999999822\n    date_modified:              2023-02-17T09:40:51.289454","content_type":"text/plain"}}},"children":[],"key":"Ty6FDMz2A5"}],"key":"WsFuNffkGQ"}],"key":"IUpz7mQctM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube_s2snowmap_masked['snowmap'] = cube_s2snowmap_masked.snowmap == 1","key":"E5Nz5mi2MZ"},{"type":"outputs","id":"5034ApwTbbhl8Ydf4UAug","children":[],"key":"A0LJQHdkV1"}],"key":"xamMsgKw5Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n_snow = cube_s2snowmap_masked.snowmap.sum(dim=['lat', 'lon'])\n\ncube_s2snowmap_masked['snow_percent'] = n_snow / (n_valid - n_cloud) * 100\ncube_s2snowmap_masked","key":"qW4hUEBR3H"},{"type":"outputs","id":"4Ofh8eUBFXoP1PM2SXaHI","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"e542bd3f951924d165640c6c7ebd3f1d","path":"/cubes-and-clouds/build/e542bd3f951924d165640c6c7ebd3f1d.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:        (lat: 166, lon: 191, time: 17, bnds: 2)\nCoordinates:\n  * lat            (lat) float64 46.95 46.95 46.95 46.95 ... 46.66 46.66 46.66\n  * lon            (lon) float64 11.02 11.02 11.03 11.03 ... 11.36 11.36 11.36\n  * time           (time) datetime64[ns] 2018-02-08T10:11:53 ... 2018-06-23T1...\n    time_bnds      (time, bnds) datetime64[ns] dask.array<chunksize=(17, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    B03            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    B11            (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    CLM            (time, lat, lon) bool dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    NDSI           (time, lat, lon) float32 dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    snowmap        (time, lat, lon) bool dask.array<chunksize=(1, 166, 191), meta=np.ndarray>\n    geometry_mask  (lat, lon) bool dask.array<chunksize=(166, 191), meta=np.ndarray>\n    cloud_percent  (time) float64 dask.array<chunksize=(1,), meta=np.ndarray>\n    snow_percent   (time) float64 dask.array<chunksize=(1,), meta=np.ndarray>\nAttributes: (12/17)\n    Conventions:                CF-1.7\n    title:                      S2L2A Data Cube Subset\n    history:                    [{'program': 'xcube_sh.chunkstore.SentinelHub...\n    date_created:               2023-02-17T09:40:08.516335\n    time_coverage_start:        2018-02-01T10:22:37+00:00\n    time_coverage_end:          2018-06-28T10:13:58+00:00\n    ...                         ...\n    processing_level:           L2A\n    geospatial_lon_units:       degrees_east\n    geospatial_lon_resolution:  0.0018000000000000028\n    geospatial_lat_units:       degrees_north\n    geospatial_lat_resolution:  0.0017999999999999822\n    date_modified:              2023-02-17T09:40:51.289454","content_type":"text/plain"}}},"children":[],"key":"KG1KqwqvMm"}],"key":"XOlwWa4p8Z"}],"key":"zO0xeCKJ2M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sca_ts = cube_s2snowmap_masked[['cloud_percent', 'snow_percent']].to_dataframe()\nsca_ts","key":"yvzxOg2z0t"},{"type":"outputs","id":"G7gb2tVrlgpak5pq04_1D","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>cloud_percent</th>\n      <th>snow_percent</th>\n    </tr>\n    <tr>\n      <th>time</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2018-02-08 10:11:53</th>\n      <td>14.107938</td>\n      <td>79.586701</td>\n    </tr>\n    <tr>\n      <th>2018-02-11 10:25:59</th>\n      <td>4.827089</td>\n      <td>74.475260</td>\n    </tr>\n    <tr>\n      <th>2018-02-13 10:15:59</th>\n      <td>18.384857</td>\n      <td>68.060348</td>\n    </tr>\n    <tr>\n      <th>2018-02-21 10:20:33</th>\n      <td>0.000000</td>\n      <td>71.934766</td>\n    </tr>\n    <tr>\n      <th>2018-02-28 10:10:21</th>\n      <td>12.765261</td>\n      <td>68.030633</td>\n    </tr>\n    <tr>\n      <th>2018-03-08 10:22:41</th>\n      <td>10.734870</td>\n      <td>85.508841</td>\n    </tr>\n    <tr>\n      <th>2018-03-20 10:10:21</th>\n      <td>11.095101</td>\n      <td>78.134669</td>\n    </tr>\n    <tr>\n      <th>2018-03-23 10:20:21</th>\n      <td>14.219282</td>\n      <td>69.458655</td>\n    </tr>\n    <tr>\n      <th>2018-03-25 10:15:11</th>\n      <td>4.466859</td>\n      <td>69.813520</td>\n    </tr>\n    <tr>\n      <th>2018-04-02 10:24:35</th>\n      <td>4.460309</td>\n      <td>68.725578</td>\n    </tr>\n    <tr>\n      <th>2018-04-07 10:20:20</th>\n      <td>0.700812</td>\n      <td>66.367654</td>\n    </tr>\n    <tr>\n      <th>2018-04-14 10:15:36</th>\n      <td>10.178150</td>\n      <td>72.582762</td>\n    </tr>\n    <tr>\n      <th>2018-04-19 10:14:57</th>\n      <td>0.000000</td>\n      <td>58.560388</td>\n    </tr>\n    <tr>\n      <th>2018-04-22 10:21:15</th>\n      <td>0.000000</td>\n      <td>54.872937</td>\n    </tr>\n    <tr>\n      <th>2018-04-24 10:15:26</th>\n      <td>18.273513</td>\n      <td>49.479083</td>\n    </tr>\n    <tr>\n      <th>2018-06-16 10:20:21</th>\n      <td>0.137543</td>\n      <td>6.388142</td>\n    </tr>\n    <tr>\n      <th>2018-06-23 10:11:39</th>\n      <td>3.163479</td>\n      <td>3.645587</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"                     cloud_percent  snow_percent\ntime                                            \n2018-02-08 10:11:53      14.107938     79.586701\n2018-02-11 10:25:59       4.827089     74.475260\n2018-02-13 10:15:59      18.384857     68.060348\n2018-02-21 10:20:33       0.000000     71.934766\n2018-02-28 10:10:21      12.765261     68.030633\n2018-03-08 10:22:41      10.734870     85.508841\n2018-03-20 10:10:21      11.095101     78.134669\n2018-03-23 10:20:21      14.219282     69.458655\n2018-03-25 10:15:11       4.466859     69.813520\n2018-04-02 10:24:35       4.460309     68.725578\n2018-04-07 10:20:20       0.700812     66.367654\n2018-04-14 10:15:36      10.178150     72.582762\n2018-04-19 10:14:57       0.000000     58.560388\n2018-04-22 10:21:15       0.000000     54.872937\n2018-04-24 10:15:26      18.273513     49.479083\n2018-06-16 10:20:21       0.137543      6.388142\n2018-06-23 10:11:39       3.163479      3.645587","content_type":"text/plain"}}},"children":[],"key":"hAOIm8w9Dq"}],"key":"eBF1BKZCYw"}],"key":"SEuKFopkh5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"XmSHkp5qyj"},{"type":"outputs","id":"t8nxGJ5Y-MI_dqseyBxRt","children":[],"key":"Sn8Fxmmq5L"}],"key":"Nk3dzUq5gP"}],"key":"g8DvapJyf4"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"3.3 Data Sharing","url":"/lectures/data-sharing/data-sharing","group":"Exercise validation"},"next":{"title":"S1","url":"/lectures/master-asi-conae/test/s1","group":"Additional materials"}}},"domain":"http://localhost:3000"}