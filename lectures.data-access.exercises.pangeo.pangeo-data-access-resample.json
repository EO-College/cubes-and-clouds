{"version":3,"kind":"Notebook","sha256":"cef3a469c609847d7bf0f6253decaee30c319f94471e80bbac13cfc82eee165c","slug":"lectures.data-access.exercises.pangeo.pangeo-data-access-resample","location":"/lectures/2.3_data_access/exercises/pangeo/23_pangeo_data_access_resample.ipynb","dependencies":[],"frontmatter":{"title":"2.3 Data Access and Basic Processing","content_includes_title":true,"kernelspec":{"name":"conda-env-cubes-and-clouds-cubes-and-clouds-pangeo-py","display_name":"cubes-and-clouds-cubes-and-clouds-pangeo","language":"python"},"github":"https://github.com/EO-college/cubes-and-clouds","subject":"Cubes and Clouds learning materials","numbering":{"title":{"offset":3}},"source_url":"https://github.com/EO-college/cubes-and-clouds/blob/main/lectures/2.3_data_access/exercises/pangeo/23_pangeo_data_access_resample.ipynb","edit_url":"https://github.com/EO-college/cubes-and-clouds/edit/main/lectures/2.3_data_access/exercises/pangeo/23_pangeo_data_access_resample.ipynb","thumbnail":"/cubes-and-clouds/build/56b77b9fff7f39fece234cf0910cdb55.svg","exports":[{"format":"ipynb","filename":"23_pangeo_data_access_resample.ipynb","url":"/cubes-and-clouds/build/23_pangeo_data_acces-5a73583b81a2195a6722a91118a8de6e.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{"523c6d79b0094ccbb324694a9a57cf31":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"VBoxModel","state":{"layout":"IPY_MODEL_b6306c1ca0534b69adae2048dcd23aa9"}},"b6306c1ca0534b69adae2048dcd23aa9":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{}}},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","children":[{"type":"image","style":{"float":"center","marginRight":"10px","marginLeft":"10px","maxHeight":"250px"},"url":"/cubes-and-clouds/build/56b77b9fff7f39fece234cf0910cdb55.svg","alt":"Cubes & Clouds logo","key":"PnbhbxZNyV","urlSource":"https://raw.githubusercontent.com/EO-College/cubes-and-clouds/main/icons/cnc_3icons_process_circle.svg"}],"key":"oVmFQENbGQ"}],"key":"df94UkuPqO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.3 Data Access and Basic Processing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BB3xcg0bYP"}],"identifier":"id-2-3-data-access-and-basic-processing","label":"2.3 Data Access and Basic Processing","html_id":"id-2-3-data-access-and-basic-processing","implicit":true,"key":"xGCJO32Vyu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","style":{"float":"center","marginRight":"10px","maxHeight":"80px"},"url":"/cubes-and-clouds/build/0f8adf2e4ec0feb14584840545a0ae3a.png","alt":"Pangeo logo","key":"nPAdM7oQJp","urlSource":"https://raw.githubusercontent.com/pangeo-data/pangeo.io/refs/heads/main/public/Pangeo-assets/pangeo_logo.png"}],"key":"PSm1TuTve2"},{"type":"heading","depth":2,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Resample Operators with Pangeo ecosystem","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eCiDpylThc"}],"identifier":"resample-operators-with-pangeo-ecosystem","label":"Resample Operators with Pangeo ecosystem","html_id":"resample-operators-with-pangeo-ecosystem","implicit":true,"key":"tWERq51Aky"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Sometimes we need to align the spatial or temporal dimension of two datacubes, so that they can be merged together.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zaL2icfbQQ"}],"key":"yBzmxf6KpX"}],"key":"OzXcjrmzEg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Spatial resampling Sentinel-2 to match Landsat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kQz56Q01PQ"}],"identifier":"spatial-resampling-sentinel-2-to-match-landsat","label":"Spatial resampling Sentinel-2 to match Landsat","html_id":"spatial-resampling-sentinel-2-to-match-landsat","implicit":true,"key":"Ejmt5WTUDi"}],"key":"EzqkmNDJSH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Start importing the necessary libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eI8U2wkwq2"}],"key":"faSvAAik6V"}],"key":"LlVn5ENdR5"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import pystac_client\nimport stackstac\nfrom rasterio.enums import Resampling","visibility":"show","key":"dq0DSscDtL"},{"type":"outputs","id":"C9JI_Al-1iqnu2bUMgQzn","children":[],"visibility":"show","key":"uhk5wrSwGC"}],"visibility":"show","key":"eWCIfhasIl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create two datacubes, one for Sentinel-2 and one for Landsat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZKfmb7VlWa"}],"key":"TBVGrK1QwQ"}],"key":"B2Io1iqTWa"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"spatial_extent = [11.4, 45.5, 11.42, 45.52]\ntemporal_extent = [\"2023-06-01\", \"2023-06-30\"]","visibility":"show","key":"ughAoFh0oX"},{"type":"outputs","id":"a6zhxR_y2qt69AGMGvu50","children":[],"visibility":"show","key":"FbFC5wtfdM"}],"visibility":"show","key":"SzGPhsLyu8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Datacube for Sentinel-2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uQZ4TDyNrY"}],"key":"Um9ZoZPXO3"}],"key":"gSXDSTfgkJ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"URL = \"https://earth-search.aws.element84.com/v1\"\ncatalog = pystac_client.Client.open(URL)\ns2_items = catalog.search(\n    bbox=spatial_extent,\n    datetime=temporal_extent,\n    collections=[\"sentinel-2-l2a\"]\n).item_collection()\n\ns2_cube = stackstac.stack(s2_items,\n                     bounds_latlon=spatial_extent,\n                     assets=[\"red\",\"nir\"]\n)\ns2_cube","visibility":"show","key":"Aw89wgbEVL"},{"type":"outputs","id":"bm6QJwFVVQk4_Jbw_i1Zx","children":[],"visibility":"show","key":"M7B96Dv8YI"}],"visibility":"show","key":"ULE1LdNi2G"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Datacube for Landsat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zwtTdE993o"}],"key":"HFnn0Mvdpz"}],"key":"gZQ3DOt9PI"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"url = \"https://planetarycomputer.microsoft.com/api/stac/v1\"\ncatalog = pystac_client.Client.open(URL)\nl8_items = catalog.search(\n    bbox=spatial_extent,\n    datetime=temporal_extent,\n    collections=[\"landsat-c2-l2\"]\n).item_collection()\n\nl8_cube = stackstac.stack(l8_items,\n                     bounds_latlon=spatial_extent,\n                     assets=[\"red\",\"nir08\"]\n)\nl8_cube","visibility":"show","key":"bXU9WQFZnM"},{"type":"outputs","id":"MIWW_NnzG4wzw15roPphL","children":[],"visibility":"show","key":"MRrCcvJrAQ"}],"visibility":"show","key":"jTi5j9DQd9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the previous outputs, notice the shape difference in the spatial dimensions ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vjFeyHSZDG"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M7fUQBwjHJ"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EeGHpLgcwM"},{"type":"inlineCode","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xtH2FamrYJ"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LQomVY94Uh"}],"key":"Yrbe3olxJX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is due to the different resolution of the two collections: 10m for Sentinel-2, 30m for Landsat.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jThH1VelMe"}],"key":"WrZh1o3O6W"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Now we use the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"e9DqDgNTq3"},{"type":"inlineCode","value":"stackstac.stack","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mBK22U66fi"},{"type":"text","value":" to load and resample the Sentinel-2 data to match Landsat.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RvxzpfZLjK"}],"key":"rUR0XK1g4F"}],"key":"p6DjfkEu1u"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"s2_cube_coarse = stackstac.stack(s2_items,\n                                 bounds_latlon=spatial_extent,\n                                 assets=[\"red\",\"nir\"],\n                                 resolution=30.0, resampling=Resampling.average, epsg=32632)\ns2_cube_coarse","visibility":"show","key":"FcPhoz6dN5"},{"type":"outputs","id":"czPOWlUCDCkr6QV3wyHOH","children":[],"visibility":"show","key":"bV2gHDGx7f"}],"visibility":"show","key":"wzTM4VNp3h"}],"key":"tCp1ONkmiB"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"2.3 Data Access and Basic Processing","url":"/lectures/data-access/exercises/pangeo/pangeo-data-access-filter","group":"Data access with pangeo"},"next":{"title":"2.3 Data Access and Basic Processing","url":"/lectures/data-access/exercises/pangeo/pangeo-data-access-aggregate","group":"Data access with pangeo"}}},"domain":"http://localhost:3000"}