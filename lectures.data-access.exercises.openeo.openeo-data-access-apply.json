{"version":3,"kind":"Notebook","sha256":"38393f77de7c3891742014e49735011046c2fb053ea206c01c2aab7ac5ec66cf","slug":"lectures.data-access.exercises.openeo.openeo-data-access-apply","location":"/lectures/2.3_data_access/exercises/openeo/23_openeo_data_access_apply.ipynb","dependencies":[],"frontmatter":{"title":"2.3 Data Access and Basic Processing","content_includes_title":true,"kernelspec":{"name":"conda-env-cubes-and-clouds-cubes-and-clouds-cubes_and_clouds_new-py","display_name":"cubes-and-clouds-cubes-and-clouds-cubes_and_clouds_new","language":"python"},"github":"https://github.com/EO-college/cubes-and-clouds","subject":"Cubes and Clouds learning materials","numbering":{"title":{"offset":3}},"source_url":"https://github.com/EO-college/cubes-and-clouds/blob/main/lectures/2.3_data_access/exercises/openeo/23_openeo_data_access_apply.ipynb","edit_url":"https://github.com/EO-college/cubes-and-clouds/edit/main/lectures/2.3_data_access/exercises/openeo/23_openeo_data_access_apply.ipynb","thumbnail":"/cubes-and-clouds/build/56b77b9fff7f39fece234cf0910cdb55.svg","exports":[{"format":"ipynb","filename":"23_openeo_data_access_apply.ipynb","url":"/cubes-and-clouds/build/23_openeo_data_acces-7e4918694275cb418eb0f9479db0d1a6.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","children":[{"type":"image","style":{"float":"center","marginRight":"10px","marginLeft":"10px","maxHeight":"250px"},"url":"/cubes-and-clouds/build/56b77b9fff7f39fece234cf0910cdb55.svg","alt":"Cubes & Clouds logo","key":"CMLKBqypPl","urlSource":"https://raw.githubusercontent.com/EO-College/cubes-and-clouds/main/icons/cnc_3icons_process_circle.svg"}],"key":"VwLHO2JO0W"}],"key":"EDv8WJiQu5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.3 Data Access and Basic Processing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HpFaCIOqY3"}],"identifier":"id-2-3-data-access-and-basic-processing","label":"2.3 Data Access and Basic Processing","html_id":"id-2-3-data-access-and-basic-processing","implicit":true,"key":"YbiS6nwuWZ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","style":{"float":"center","marginRight":"10px","maxHeight":"100px"},"url":"/cubes-and-clouds/build/7d92286654718ed077e8b148b8c89bdd.png","alt":"openEO logo","key":"kqTFsbIa9K","urlSource":"https://openeo.org/images/openeo_logo.png"}],"key":"yqBaiwKRVq"},{"type":"heading","depth":2,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Apply Operator with openEO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kgnloIAHLN"}],"identifier":"apply-operator-with-openeo","label":"Apply Operator with openEO","html_id":"apply-operator-with-openeo","implicit":true,"key":"mnsab3txE2"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The apply operator applies a process to each value in the data cube (i.e. a local operation).","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"RDN5RcTMmx"}],"key":"GdNotC6Fq7"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Letâ€™s start again with the same sample data from the Sentinel-2 STAC Collection, applying the filters directly in the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XW4LsFT8ne"},{"type":"inlineCode","value":"load_stac","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"EBz9JKDOXS"},{"type":"text","value":" call, to reduce the amount of data.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Eo4xL5liGd"}],"key":"SmlrtT8Pcp"}],"key":"KuIlaPDlEH"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import openeo\nfrom openeo.local import LocalConnection\nlocal_conn = LocalConnection('')\n\nurl = \"https://earth-search.aws.element84.com/v1/collections/sentinel-2-l2a\"\nspatial_extent = {\"west\": 11.259613, \"east\": 11.406212, \"south\": 46.461019, \"north\": 46.522237}\ntemporal_extent = ['2022-07-10T00:00:00Z','2022-07-13T00:00:00Z']\nbands = [\"red\",\"green\",\"blue\"]\nproperties = {\"eo:cloud_cover\": dict(lt=50)}\ndatacube = local_conn.load_stac(url=url,\n                    spatial_extent=spatial_extent,\n                    temporal_extent = temporal_extent,\n                    bands=bands,\n                    properties=properties\n)\n\ndatacube.execute()","visibility":"show","key":"HrfpkeBt5I"},{"type":"outputs","id":"INfpC9AAwKnZDU7FX4cvi","children":[],"visibility":"show","key":"dO8zornGar"}],"visibility":"show","key":"PeAHbwz0uJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the RGB bands of our sample dataset:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X4qTrKEoUR"}],"key":"ozeF1xj4dP"}],"key":"BkLlP6BEJI"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"data = datacube.execute()\ndata[0].plot.imshow()","visibility":"show","key":"DgTeFoGU5i"},{"type":"outputs","id":"bBIQnLvlkb-lKHgPzck6v","children":[],"visibility":"show","key":"fyRup004wh"}],"visibility":"show","key":"BRJy5iI4D7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Apply an arithmetic formula","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hfbHgyYFFs"}],"identifier":"apply-an-arithmetic-formula","label":"Apply an arithmetic formula","html_id":"apply-an-arithmetic-formula","implicit":true,"key":"ynwpuCwXwn"}],"key":"kMHrfZ72YI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We would like to improve the previous visualization, rescaling all the pixels between 0 and 1.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VNRZ8zNWPf"}],"key":"Efl0414rIl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can use ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pssCZKzpWu"},{"type":"inlineCode","value":"apply","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WRSDr37jtx"},{"type":"text","value":" in combination with the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QULok0TqXG"},{"type":"inlineCode","value":"linear_scale_range","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yxSAY7UweJ"},{"type":"text","value":" processe.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sttUKJXwPp"}],"key":"WaHNg8UZrx"}],"key":"XoaOB4wrCY"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from openeo.processes import linear_scale_range\ninput_min = -0.1\ninput_max = 0.2\noutput_min = 0\noutput_max = 1\n\ndef rescale(x):\n    return linear_scale_range(x,input_min,input_max,output_min,output_max)\n\nscaled_data = datacube.apply(rescale)\nscaled_data","visibility":"show","key":"QMTaKbazd2"},{"type":"outputs","id":"yL-4BmGxC95ga8tMc-L5J","children":[],"visibility":"show","key":"Qx8MtqNw3j"}],"visibility":"show","key":"WyBlnvvV7u"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the result and see how ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CJsEyDkTRa"},{"type":"inlineCode","value":"apply","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bTRfLkCbUw"},{"type":"text","value":" scaled the data resulting in a more meaningful visualization:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m40qAQXhV7"}],"key":"X1S7b9Lh6M"}],"key":"wjB0RWvjam"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"scaled_data_xr = scaled_data.execute()\nscaled_data_xr[0].plot.imshow()","visibility":"show","key":"yHR3GNnZVm"},{"type":"outputs","id":"k_3dHr-GEKER8VLLxC6Hq","children":[],"visibility":"show","key":"gEsShc0DqV"}],"visibility":"show","key":"CdOYldLt50"}],"key":"SAsH90SWNU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"2.3 Data Access and Basic Processing","url":"/lectures/data-access/exercises/openeo/openeo-data-access-aggregate","group":"Data access with OpenEO"},"next":{"title":"Access EO Data from the Cloud","url":"/lectures/data-access/data-access-1","group":"Data access with pangeo"}}},"domain":"http://localhost:3000"}