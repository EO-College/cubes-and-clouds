# Data Discovery

## Learning Objectives

- Find out what Data Sources we have
- Get to know where to get data
- Discover data catalogues
- Learn what is STAC

## What kind of data is available

#### Video: What kind of data can you find? And how?

## Geospatial Data

Knowledge of various geospatial data types is essential for understanding, representing, and analyzing acquired data from various domains. Data carry not only spatial information but also measured values, derived data, or other targeted information. Based on their properties, they can be used for different purposes.

There are several common geospatial data types, each serving a specific purpose and having distinct characteristics.

### Raster data

Raster data are represented as pixels and grid cells where every pixel has a value associated with it. Data stored in raster format can be discrete (representing distinct categories, eg. land cover types) or continuous (for example temperature or elevation).

Examples of raster data sources:

- **Satellite data**  - Satellite imagery data are a common example of raster data. There are many types of data acquired by satellites and their processing. The temporal aspect of images is very important for continuous analysis. 
- **Aerial/drone orthophoto** - Digital imagery obtained by aircrafts (e.g. drones) is usually high-resolution raster data usable for detailed analysis.
- **DEM** - Digital Elevation Models are representing the surface of (usually) Earth and are essential for computations on a surface level.

### Vector data

Vector data are a fundamental type of geospatial data. Vector data represents spatial features using 3 basic classes -  points, lines, and polygons and the attributes associated with them. With vector data, it is possible to capture and analyze complex spatial patterns and attributes with great accuracy, providing valuable insights into spatial phenomena and supporting decision-making processes. Vector data are commonly used in addition to raster data to highlight or accompany trends and results.

Examples of vector data sources we will use in this course:

- **Land/sea mask** - A land/sea mask is usually a layer that identifies and delineates the land areas on a map or satellite image. It essentially acts as a filter or overlay that separates land from non-land areas, such as oceans, lakes, and other bodies of water. The land mask is typically represented as a binary or categorical, where land areas are assigned a specific value or classification while non-land areas are assigned another value.

- **Surface classification mask** - Surface mask acts as a classifier for different surface types and assigns each of them a distinct categorical value. Common types can be water, vegetation, or build-up areas

- **Cloud mask** - Cloud mask refers to the task of cloud detection in optical satellite data, where the common task is to detect (and remove) clouds to obtain better quality data.

### In-situ data

In-situ data are data collected directly at the place of interest and are connected to a special location. There are many reasons why these data are important and one of them is an enhancement of data collected by other means eg. weather measurements from satellites enhanced with local air quality measurements. There are many examples of what can be measured:

- **Temperature measurement**  
- **Soil quality measurement**

### Datacubes

Datacube refers to a multidimensional representation of data that incorporates spatial and temporal dimensions. It is a concept used to organize and analyze large volumes of geospatial information in a structured and efficient manner. Datacubes are combining the data types discussed above into one data structure. More about datacubes is in [Lesson 1.2](../1.2/datacubes.md)

### Further Reading

### References

# EO Catalog protocols

For earth observation data discovery, it is essential to know about various used catalog protocols that define standardized methods and formats for organizing, describing, and accessing Earth observation data catalogs. 

Some commonly used protocols shared between diffent platforms include **OpenSearch**, **OGC CSW**, **OGC API - Records**, **STAC**, **OData** and more.

## OpenSearch

The OpenSearch specification was launched in 2005 by A9.com, an Amazon subsidiary, as a means for sharing search queries and search results in a standardized format.
The specification was intended to allow syndication of search results that could then be aggregated by one large index.
OpenSearch provides a simple to use description of the search interface, which is called an OpenSearch Description document (OSDD).
A client (e.g., a browser) can use this description to check which response formats are supported and how a query/filter can be formulated.
The OpenSearch based REST services are usually offered by existing EO data platforms for compatibility reasons as the protocol itself is stable and not extended anymore.
The data models of most catalogs build on top of XML or GeoJSON and allow filtering on a set of simple but not standardized properties. The protocol supports both textual and geospatial search and filtering capabilities, making it suitable for a wide range of applications, including web search engines and geospatial data catalogs.

## OGC CSW

Catalogue Service for the Web (CSW) standardized by Open Geospatial Consortium (OGC), offers a framework for publishing, discovering, and accessing metadata records, allowing users to effectively search and retrieve geospatial data and related information. The catalogue is made up of records that describe geospatial data, linked geospatial services and related resources.
CSW enables metadata query using metadata core (mandatory) elements.
Catalogue services support the use of one of several identified query languages to find and return results using well-known content models (metadata schemas) and encodings.

## OGC API - Features

OGC API - Features is a modern and flexible geospatial data access protocol developed by the OGC. It provides a standardized and RESTful approach for querying, retrieving, and manipulating geospatial feature data over the web. By leveraging the power of web technologies such as HTTP, JSON, and GeoJSON, OGC API - Features simplifies the process of accessing and working with geospatial data. It allows users to retrieve specific features based on spatial and attribute filters, perform spatial and attribute queries, and even modify feature data through standard HTTP methods.

## OGC API - Records

OGC API - Records is a multi-part draft specification (built on top of OGC API - Features) that offers the capability to create, modify, and query metadata on the Web. The draft specification enables the discovery of geospatial resources by standardizing the way collections of descriptive information about the resources (metadata) are exposed. The specification also enables the discovery and sharing of related resources that may be referenced from geospatial resources or their metadata by standardizing the way all kinds of records are exposed and managed.

## STAC

STAC stands for SpatioTemporal Asset Catalog. It is a community specification that provides a common structure for describing and cataloging spatiotemporal assets - files that represents information about the earth captured in a certain space and time. STAC specification focuses on organizing and sharing geospatial data in a way that is accessible, interoperable, and scalable. The STAC Specification consists of 4 semi-independent specifications which can work independently or be used together.
It is a relatively new specification but increasingly integrated by various data providers and seen as future of EO Data cataloguing and discovery. The data model in the dataspace is still evolving to comply fully with all standardized properties. Because of that, more attention is provided to STAC than other catalogue protocols in this tutorial.


### The components of STAC
- **STAC Item**

A STAC Item is the foundational building block of STAC. It is a GeoJSON feature supplemented with additional metadata that enables clients to traverse through catalogs. Since an item is a GeoJSON, it can be easily read by any modern GIS or geospatial library. One item can describe one or more SpatioTemporal Asset(s). For example, a common practice of using STAC for imagery is that each band in a scene is its own STAC Asset and there is one STAC Item to represent all the bands in a single scene.

The STAC Item JSON specification uses standard GeoJSON fields as well as a few additional informational fields to describe the asset(s) more thoroughly.

- **STAC Catalog**

A STAC Catalog is a top-level object that logically groups other Catalog, Collection, and Item objects. A Catalog contains an array of Link objects to these other objects and can include additional metadata to describe the objects contained therein. A catalog is usually the starting point for navigating a STAC. A catalog.json file contains links to some combination of other STAC Catalogs, Collections, and/or Items. We can think of it like a directory tree on a computer.

There are no restrictions on the way STAC Catalogs are organized. Therefore, the combination of STAC components within a STAC Catalog is quite variable and flexible. Many implementations use a set of 'sub-catalog(s)' that group the items in some sensible way. It can be easily extended, for example, to include additional metadata to further describe its holdings, as the STAC Collection does.

- **STAC Colection**

A STAC Collection builds upon the STAC Catalog specification to include additional metadata about a set of items that exist as part of the collection. It extends the parent catalog by adding additional fields to enable the description of information like the spatial and temporal extent of the data, the license, keywords, providers, etc. Therefore, it can easily be extended for additional collection-level metadata.

- **STAC API**

STAC API is a dynamic version of a SpatioTemporal Asset Catalog and provides a RESTful endpoint that enables the search of STAC Item, Catalog, Collection or STAC API ItemCollection objects. If the API implements the 'filter' extension, additionally the user is allowed to filter returned content on various metadata fields by supported query languages is possible (again depending on the extent of implemented extensions of the catalog).

- **STAC Extension**

Extensions to STAC are an important addition to the core STAC specification and provide additional JSON fields that can be used to better describe the data. Most tend to be about describing a particular domain or type of data. To find out which extensions do the STAC Catalog, Collection or Item object implement, check the list of extension IDs of the in the  stac_extensions array.

#### Animated Content: Relate the components of STAC (drag and drop)

**TO DO: Integrate Screenscats on STAC Browser from here:  https://mohr.ws/foss4g/**

## ODAta

OData (Open Data Protocol) specifies a variety of best practices for creating and using REST APIs that can be handled by a large set of client tools like common web browsers, download-managers. The OData protocol can be used for building URI for performing search queries and product downloads for example on the Copernicus Open Access Hub (Scihub).

### References and further readings

- [OpenSearch specification] https://github.com/dewitt/opensearch 
- [OGC OpenSearch Geo, Time and EO extensions] https://www.ogc.org/standard/opensearch
- [OpenSearch API access examples] https://documentation.dataspace.copernicus.eu/APIs/OpenSearch.html
- [OGC CSW specification] https://www.ogc.org/standard/cat/
- [OGC API - Features] https://www.ogc.org/standard/ogcapi-features/
- [OGC API - Records (Draft)] https://docs.ogc.org/DRAFTS/20-004.html
- More to read about STAC [STAC specification](https://stacspec.org/en)
- [STAC Tutorials](https://stacspec.org/en/tutorials/)

## Where to search for data

Earth observation data access is not limited to a single platform or a single entry point. What follows is a non-exhaustive list of some well-known Earth observation data catalogues usually based around the original agency providing the data:

- [EarthData Search](https://search.earthdata.nasa.gov/search): A comprehensive data discovery and access tool provided by NASA's Earth Observing System Data and Information System (EOSDIS). Contains wide range of NASA's Earth science data.
- [Copernicus Open Access Hub (SciHub)](https://scihub.copernicus.eu/): provides complete, free and open access to Sentinel-1, Sentinel-2, Sentinel-3 and Sentinel-5P user products
- [Copernicus Data Space](https://dataspace.copernicus.eu/explore-data/data-collections): Currently in development platform aiming to provide immediate access to large amounts of open and free Earth observation data and scalable interfaces including both new and historical Sentinel images, commercial datasets, as well as Copernicus Contributing Missions.
- [USGS Earth Explorer](https://earthexplorer.usgs.gov/): EarthExplorer (EE) provides online search, browse display, metadata export, and data download for earth science data from the archives of the U.S. Geological Survey (USGS). Usually of largest demand are data from the Landsat missions.
- [Open Science Catalog](https://opensciencedata.esa.int/): A catalog of publicly available geoscience products, datasets and resources developed in the frame of scientific research Projects funded by ESA EO. Queriable by themes, projects, variables and products.
- [NCEI Catalog](https://www.ncei.noaa.gov/access): NOAA's National Centers for Environmental Information (NCEI) provides access to various environmental data, including satellite imagery, climate data, and other geospatial datasets. In particular it is composed of oceanic, atmospheric, and geophysical data.
- [STAC Index](https://stacindex.org/catalogs): A curated list of publicly available STAC APIs and Static Catalogs.

#### Animated Content: Data Catalogue (embed viewer)
Embed a openly available STAC browser (maybe openEO platform)
<iframe width="1000" height="600" src="https://openeo.cloud/data-collections/" title="openEO platform collections" frameborder="0" allowfullscreen></iframe>

## How to search for data

Large EO data portals usually allow two different ways of access based on the technical proficiency of the target user group.

### Web Browser Catalogue client

Many large portals provide a easy-to-use search and filtering GUI, which under the hood uses one of the provided catalog APIs. This allows less experienced users to perform queries usually for smaller subset of data with the help of an attached Web map client to orient themselves easily.

### API access

For batch operations or script access to the catalogs, it is envisioned that direct approach of the API is performed instead. This removes the need for direct user interaction to the web platform and can be used from user provided scripts or other programs and CLI tools.

Fore more information about performing filtering or queries, see [Data Properties](../2.2_data_properties/2.2_properties.md).

### STAC Browser

In order to access and browse any online STAC catalog or API, a rich web client application STAC Browser can be used on [radiantearth.github.io/stac-browser](https://radiantearth.github.io/stac-browser). It does not allow any filtering capabilities.

### STAC QGIS plugin

[QGIS STAC API Browser](https://stac-utils.github.io/qgis-stac-plugin/) provides a simple and user-friendly approach in searching and using STAC API resources in QGIS. It offers a comfortable way to filter and browse the STAC API items and ability to add the STAC API assets as map layers into the QGIS.

### QGIS MetaSearch Catalog Client

[MetaSearch](https://docs.qgis.org/3.28/en/docs/user_manual/plugins/core_plugins/plugins_metasearch.html) is a QGIS plugin to interact with metadata catalog services, supporting both the OGC API - Records and OGC Catalog Service for the Web (CSW) standards.

### OWSLib

[OWSLib](https://owslib.readthedocs.io/en/latest/) is a Python package for client programming with Open Geospatial Consortium (OGC) web service (hence OWS) interface standards, and their related content models. The OWSLib client offers support for OGC CSW, OGC API - Records and OpenSearch based catalog services.

### PySTAC client

The [STAC Python Client (pystac_client)](https://pystac-client.readthedocs.io/en/stable/) is a Python package for working with STAC Catalogs and APIs that conform to the STAC and STAC API specs in a seamless way. PySTAC Client builds upon PySTAC through higher-level functionality and ability to leverage STAC API search endpoints.

### Animations

Video STAC visualization in leaflet: https://github.com/giswqs/leafmap/pull/347 

## Exam

Let's test now your understanding of data types and where to find them. We will be working with data shortly in the next chapters!

### Geospatial Data
- What kind of main data types we have
- **To Do**: Think of different question; snow workflow is not introduced yet. ***What are key data types used in snow workflow***

### STAC 
- What is STAC stands for
- What are mandatory properties of STAC item?
- What does not belong to STAC Catalog?

### Data Catalogs and Access Protocols

- What is an access protocol
- **To Do**: Change, snow workflow not introduced yet. ***Find collections needed for the snow workflow***
    - where to get direct access
    - where to download data
    - where to use through platforms
- Compare data availability between platforms - is same data product available on both?
- Test if you can search over the anti-meridian (180 longitude) in your chosen catalogue (list multiple and true/false answers)


### References

## Links
