{"version":3,"kind":"Notebook","sha256":"11a3d142fa1beda823e397ee104554b6010ad2a4b26bb55484d3e2dc6a879d15","slug":"lectures.master-asi-conae.test.s3-ndsi","location":"/lectures/9.9_master_asi_conae/test/s3_ndsi.ipynb","dependencies":[],"frontmatter":{"title":"List all the available dataset","content_includes_title":true,"kernelspec":{"name":"conda-env-master-asi-conae-edc-2022.10-14-py","display_name":"master-asi-conae-edc-2022.10-14","language":"python"},"github":"https://github.com/EO-college/cubes-and-clouds","subject":"Cubes and Clouds learning materials","numbering":{"title":{"offset":3}},"source_url":"https://github.com/EO-college/cubes-and-clouds/blob/main/lectures/9.9_master_asi_conae/test/s3_ndsi.ipynb","edit_url":"https://github.com/EO-college/cubes-and-clouds/edit/main/lectures/9.9_master_asi_conae/test/s3_ndsi.ipynb","exports":[{"format":"ipynb","filename":"s3_ndsi.ipynb","url":"/cubes-and-clouds/build/s3_ndsi-227afd282bf2861024068ccf16bce46a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# xcube_sh imports\nfrom xcube_sh.cube import open_cube\nfrom xcube_sh.config import CubeConfig\nfrom xcube_sh.sentinelhub import SentinelHub\n\n# xcube imports\nfrom xcube.core.geom import mask_dataset_by_geometry\n\n# Various utilities\nfrom datetime import date\nimport numpy as np\nimport pandas as pd\nimport geopandas as gpd\nimport matplotlib.pyplot as plt","key":"dNMDjVJroT"},{"type":"outputs","id":"oH_0kcJQYWKEzyO0XzXIe","children":[],"key":"N8UZbbzvpQ"}],"key":"yPRJpExiL9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the catchment outline","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dCa2EvIYUT"}],"key":"LnucNSmXNV"}],"key":"DMe4fkmSo7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"catchment_outline = gpd.read_file('catchment_outline.geojson')","key":"lcN5Tn4K9N"},{"type":"outputs","id":"oHqu3yf0YG21Jq1iQ4iLH","children":[],"key":"Xh5rPMHmgN"}],"key":"SncOaMnbQ5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"List all the available dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qakvdDgFkB"}],"identifier":"list-all-the-available-dataset","label":"List all the available dataset","html_id":"list-all-the-available-dataset","implicit":true,"key":"CNsvGaVlFB"}],"key":"iNjexOnBZy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"SH = SentinelHub()\nSH.dataset_names","key":"aSyawDTqNg"},{"type":"outputs","id":"E_OT1T5RekOnU19BY6juw","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"['LETML1',\n 'LOTL1',\n 'LETML2',\n 'CUSTOM',\n 'LMSSL1',\n 'LTML2',\n 'LOTL2',\n 'S3OLCI',\n 'S3SLSTR',\n 'DEM',\n 'MODIS',\n 'S5PL2',\n 'HLS',\n 'LTML1',\n 'S1GRD',\n 'S2L2A',\n 'S2L1C']","content_type":"text/plain"}}},"children":[],"key":"Uyi7uNt3zV"}],"key":"f8G2NfN3wT"}],"key":"fedU8YFBef"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"SH.band_names('S3SLSTR')","key":"zbRL3EJimf"},{"type":"outputs","id":"Lv4dLgOwacu3lrMkwyjcH","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"['S1',\n 'S2',\n 'S3',\n 'S4',\n 'S4_A',\n 'S4_B',\n 'S5',\n 'S5_A',\n 'S5_B',\n 'S6',\n 'S6_A',\n 'S6_B',\n 'S7',\n 'S8',\n 'S9',\n 'F1',\n 'F2',\n 'CLOUD_FRACTION',\n 'SEA_ICE_FRACTION',\n 'SEA_SURFACE_TEMPERATURE',\n 'DEW_POINT',\n 'SKIN_TEMPERATURE',\n 'SNOW_ALBEDO',\n 'SNOW_DEPTH',\n 'SOIL_WETNESS',\n 'TEMPERATURE',\n 'TOTAL_COLUMN_OZONE',\n 'TOTAL_COLUMN_WATER_VAPOR']","content_type":"text/plain"}}},"children":[],"key":"byeiTT66Au"}],"key":"wIbEiOhlpS"}],"key":"fLNcemCh2U"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Configuring the data content of the cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v9NjN9pViU"}],"key":"IuZqmNEkNn"}],"key":"Q75Toyejfg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bbox = catchment_outline.bounds.iloc[0]\n\nstart_date = date(2021, 2, 1)\nend_date = date(2021, 7, 1)\n\ncube_config = CubeConfig(\n    dataset_name='S3SLSTR',\n    band_names=['S1', 'S2', 'S3', 'S5', 'S6', 'F1', 'SNOW_DEPTH', 'SNOW_ALBEDO'],\n    bbox=bbox.tolist(),\n    spatial_res=0.009,   # = 500 meters in degree>\n    time_range=[start_date.strftime(\"%Y-%m-%d\"), end_date.strftime(\"%Y-%m-%d\")]\n)","key":"UvdQluVeOC"},{"type":"outputs","id":"FraAVNBCN_78_-o-yJDs4","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/conda/master-asi-conae/315434deb1b1e05eacacc41e1b0529b1837100f46402a32041d77ba54ae6c5f3-20230213-125825-013239-74-edc-2022.10-14/lib/python3.9/site-packages/xcube_sh/config.py:248: FutureWarning: Units 'M', 'Y' and 'y' do not represent unambiguous timedelta values and will be removed in a future version.\n  time_tolerance = pd.to_timedelta(time_tolerance)\n"},"children":[],"key":"hxonrR3Enu"}],"key":"vkdoeKvxos"}],"key":"VEY6NqOzI2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube = open_cube(cube_config, api_url=\"https://creodias.sentinel-hub.com\")\ncube","key":"GV6DbIPyDc"},{"type":"outputs","id":"-c2LCcb2GERgE7JEjpIuk","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"56ad409853cc464db750e1132761c0c3","path":"/cubes-and-clouds/build/56ad409853cc464db750e1132761c0c3.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:      (time: 353, lat: 33, lon: 38, bnds: 2)\nCoordinates:\n  * lat          (lat) float64 46.95 46.94 46.93 46.92 ... 46.68 46.67 46.66\n  * lon          (lon) float64 11.03 11.03 11.04 11.05 ... 11.34 11.35 11.36\n  * time         (time) datetime64[ns] 2021-02-01T09:57:08 ... 2021-06-30T20:...\n    time_bnds    (time, bnds) datetime64[ns] dask.array<chunksize=(353, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    F1           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S1           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S2           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S3           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S5           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S6           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    SNOW_ALBEDO  (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    SNOW_DEPTH   (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\nAttributes:\n    Conventions:             CF-1.7\n    title:                   S3SLSTR Data Cube Subset\n    history:                 [{'program': 'xcube_sh.chunkstore.SentinelHubChu...\n    date_created:            2023-02-21T09:41:27.870387\n    time_coverage_start:     2021-02-01T09:37:22.665000+00:00\n    time_coverage_end:       2021-06-30T20:36:19.311000+00:00\n    time_coverage_duration:  P149DT10H58M56.646S\n    geospatial_lon_min:      11.020833333333357\n    geospatial_lat_min:      46.653599378797765\n    geospatial_lon_max:      11.362833333333358\n    geospatial_lat_max:      46.95059937879776\n    processing_level:        L1B","content_type":"text/plain"}}},"children":[],"key":"Kv0aKPJXoZ"}],"key":"CfuKZaLKNa"}],"key":"OdODGoBSyF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.SNOW_DEPTH.sel(time='2018-04-02T10:24:35.000000000', method='nearest').plot.imshow()","key":"rE2KTEfkOY"},{"type":"outputs","id":"q0gP8GGdUjFbORKeq-99z","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b8befdfa7401005f3a6c700840cdfc34","path":"/cubes-and-clouds/build/b8befdfa7401005f3a6c700840cdfc34.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"wgvQ3TA26e"}],"key":"SSs37Ds6UN"}],"key":"CAnrshygWc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.SNOW_ALBEDO.sel(time='2018-04-02T10:24:35.000000000', method='nearest').plot.imshow()","key":"B8jYyd5lDm"},{"type":"outputs","id":"abqBbsGDTrpedAi3XSJpC","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"959332d8e3091a58eb18f7842440fc24","path":"/cubes-and-clouds/build/959332d8e3091a58eb18f7842440fc24.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"Ne2fNfPAif"}],"key":"TzqZxuvctJ"}],"key":"yfCvSaV7SJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.S2.sel(time='2018-05-09', method='nearest').plot.imshow()","key":"yVOkEmmb7a"},{"type":"outputs","id":"n5xPd2bpR67SPTStYrl3f","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4c8ed1ee9278874c32b4d925170a7b37","path":"/cubes-and-clouds/build/4c8ed1ee9278874c32b4d925170a7b37.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"DhylMErhSN"}],"key":"HUX0hwaHkO"}],"key":"UL63ox01Et"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.F1.sel(time='2018-04-02T10:24:35.000000000', method='nearest').plot.imshow()","key":"pnWqjDfMNn"},{"type":"outputs","id":"5sJePpRYy5Ks4J02fAcwp","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2b612383b7bc6bb460b2e00f64ad80e2","path":"/cubes-and-clouds/build/2b612383b7bc6bb460b2e00f64ad80e2.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"vLS5XaJrke"}],"key":"bYs5YbU3cB"}],"key":"ihoYuF2IVj"}],"key":"X1bp7L5Qfw"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Sentinel-2 snow cover","url":"/lectures/master-asi-conae/test/s2-snowcover-test","group":"Test"},"next":{"title":"Sentinel-1","url":"/lectures/master-asi-conae/test/test-s1-s3","group":"Test"}}},"domain":"http://localhost:3000"}