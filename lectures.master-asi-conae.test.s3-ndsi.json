{"version":3,"kind":"Notebook","sha256":"11a3d142fa1beda823e397ee104554b6010ad2a4b26bb55484d3e2dc6a879d15","slug":"lectures.master-asi-conae.test.s3-ndsi","location":"/lectures/9.9_master_asi_conae/test/s3_ndsi.ipynb","dependencies":[],"frontmatter":{"title":"List all the available dataset","content_includes_title":true,"kernelspec":{"name":"conda-env-master-asi-conae-edc-2022.10-14-py","display_name":"master-asi-conae-edc-2022.10-14","language":"python"},"github":"https://github.com/EO-college/cubes-and-clouds","subject":"Cubes and Clouds learning materials","numbering":{"title":{"offset":3}},"source_url":"https://github.com/EO-college/cubes-and-clouds/blob/main/lectures/9.9_master_asi_conae/test/s3_ndsi.ipynb","edit_url":"https://github.com/EO-college/cubes-and-clouds/edit/main/lectures/9.9_master_asi_conae/test/s3_ndsi.ipynb","exports":[{"format":"ipynb","filename":"s3_ndsi.ipynb","url":"/cubes-and-clouds/build/s3_ndsi-682a2700f1a133a2525f3d1382da4532.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# xcube_sh imports\nfrom xcube_sh.cube import open_cube\nfrom xcube_sh.config import CubeConfig\nfrom xcube_sh.sentinelhub import SentinelHub\n\n# xcube imports\nfrom xcube.core.geom import mask_dataset_by_geometry\n\n# Various utilities\nfrom datetime import date\nimport numpy as np\nimport pandas as pd\nimport geopandas as gpd\nimport matplotlib.pyplot as plt","key":"zTO6DnoZDP"},{"type":"outputs","id":"OnuGn6nS8aDEEchy5eTmL","children":[],"key":"RlK9HbqnAt"}],"key":"nFMCm6Q6vA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the catchment outline","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fH5LEvABI2"}],"key":"rMsgNvecjs"}],"key":"dtEFXW17nu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"catchment_outline = gpd.read_file('catchment_outline.geojson')","key":"A6mNnt1tJ1"},{"type":"outputs","id":"EedG2KdTCkNEhxjiDGAe2","children":[],"key":"vNfsEU4mwS"}],"key":"QgB6j5tItJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"List all the available dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zIFU8OFWXS"}],"identifier":"list-all-the-available-dataset","label":"List all the available dataset","html_id":"list-all-the-available-dataset","implicit":true,"key":"njMiOXTr9v"}],"key":"oPQCvhevLl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"SH = SentinelHub()\nSH.dataset_names","key":"NAPg2SnfDs"},{"type":"outputs","id":"-g3_VtHrqiXIhw630hagG","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"['LETML1',\n 'LOTL1',\n 'LETML2',\n 'CUSTOM',\n 'LMSSL1',\n 'LTML2',\n 'LOTL2',\n 'S3OLCI',\n 'S3SLSTR',\n 'DEM',\n 'MODIS',\n 'S5PL2',\n 'HLS',\n 'LTML1',\n 'S1GRD',\n 'S2L2A',\n 'S2L1C']","content_type":"text/plain"}}},"children":[],"key":"ECRQtQBSkM"}],"key":"sgPuhzNSgk"}],"key":"CAhun1Jdrr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"SH.band_names('S3SLSTR')","key":"fBxW5b7COU"},{"type":"outputs","id":"p2_4SWCxFjjiWDh5ifcnn","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"['S1',\n 'S2',\n 'S3',\n 'S4',\n 'S4_A',\n 'S4_B',\n 'S5',\n 'S5_A',\n 'S5_B',\n 'S6',\n 'S6_A',\n 'S6_B',\n 'S7',\n 'S8',\n 'S9',\n 'F1',\n 'F2',\n 'CLOUD_FRACTION',\n 'SEA_ICE_FRACTION',\n 'SEA_SURFACE_TEMPERATURE',\n 'DEW_POINT',\n 'SKIN_TEMPERATURE',\n 'SNOW_ALBEDO',\n 'SNOW_DEPTH',\n 'SOIL_WETNESS',\n 'TEMPERATURE',\n 'TOTAL_COLUMN_OZONE',\n 'TOTAL_COLUMN_WATER_VAPOR']","content_type":"text/plain"}}},"children":[],"key":"EiuZ7BMr8S"}],"key":"hh8kjV8Gyu"}],"key":"otVbiH4iXD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Configuring the data content of the cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q2xnwmhWLg"}],"key":"seQ442NrIB"}],"key":"S8zWytNH02"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bbox = catchment_outline.bounds.iloc[0]\n\nstart_date = date(2021, 2, 1)\nend_date = date(2021, 7, 1)\n\ncube_config = CubeConfig(\n    dataset_name='S3SLSTR',\n    band_names=['S1', 'S2', 'S3', 'S5', 'S6', 'F1', 'SNOW_DEPTH', 'SNOW_ALBEDO'],\n    bbox=bbox.tolist(),\n    spatial_res=0.009,   # = 500 meters in degree>\n    time_range=[start_date.strftime(\"%Y-%m-%d\"), end_date.strftime(\"%Y-%m-%d\")]\n)","key":"gmQoBgD1UL"},{"type":"outputs","id":"0q7Hw7k7OzPrLpUgEqUE4","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/conda/master-asi-conae/315434deb1b1e05eacacc41e1b0529b1837100f46402a32041d77ba54ae6c5f3-20230213-125825-013239-74-edc-2022.10-14/lib/python3.9/site-packages/xcube_sh/config.py:248: FutureWarning: Units 'M', 'Y' and 'y' do not represent unambiguous timedelta values and will be removed in a future version.\n  time_tolerance = pd.to_timedelta(time_tolerance)\n"},"children":[],"key":"Sp2IIqMDh8"}],"key":"xR04oZMnwy"}],"key":"tpotzGlXlz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube = open_cube(cube_config, api_url=\"https://creodias.sentinel-hub.com\")\ncube","key":"p5CM83EPZE"},{"type":"outputs","id":"ihscfkJlJr6jGvIGYXZjY","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"56ad409853cc464db750e1132761c0c3","path":"/cubes-and-clouds/build/56ad409853cc464db750e1132761c0c3.html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:      (time: 353, lat: 33, lon: 38, bnds: 2)\nCoordinates:\n  * lat          (lat) float64 46.95 46.94 46.93 46.92 ... 46.68 46.67 46.66\n  * lon          (lon) float64 11.03 11.03 11.04 11.05 ... 11.34 11.35 11.36\n  * time         (time) datetime64[ns] 2021-02-01T09:57:08 ... 2021-06-30T20:...\n    time_bnds    (time, bnds) datetime64[ns] dask.array<chunksize=(353, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    F1           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S1           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S2           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S3           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S5           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    S6           (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    SNOW_ALBEDO  (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\n    SNOW_DEPTH   (time, lat, lon) float32 dask.array<chunksize=(1, 33, 38), meta=np.ndarray>\nAttributes:\n    Conventions:             CF-1.7\n    title:                   S3SLSTR Data Cube Subset\n    history:                 [{'program': 'xcube_sh.chunkstore.SentinelHubChu...\n    date_created:            2023-02-21T09:41:27.870387\n    time_coverage_start:     2021-02-01T09:37:22.665000+00:00\n    time_coverage_end:       2021-06-30T20:36:19.311000+00:00\n    time_coverage_duration:  P149DT10H58M56.646S\n    geospatial_lon_min:      11.020833333333357\n    geospatial_lat_min:      46.653599378797765\n    geospatial_lon_max:      11.362833333333358\n    geospatial_lat_max:      46.95059937879776\n    processing_level:        L1B","content_type":"text/plain"}}},"children":[],"key":"nJaseustjc"}],"key":"OqD9D2HRPg"}],"key":"Gfymdot63j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.SNOW_DEPTH.sel(time='2018-04-02T10:24:35.000000000', method='nearest').plot.imshow()","key":"Tm3ecstxl8"},{"type":"outputs","id":"ptaRSjS-97CKGUO_yVTaE","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b8befdfa7401005f3a6c700840cdfc34","path":"/cubes-and-clouds/build/b8befdfa7401005f3a6c700840cdfc34.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"VKT5NwjRU3"}],"key":"bYzQUgkVcZ"}],"key":"XTKRzV52pG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.SNOW_ALBEDO.sel(time='2018-04-02T10:24:35.000000000', method='nearest').plot.imshow()","key":"e1oEpo4fTt"},{"type":"outputs","id":"9t4k7gE0jzw4PUZPp17g2","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"959332d8e3091a58eb18f7842440fc24","path":"/cubes-and-clouds/build/959332d8e3091a58eb18f7842440fc24.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"BVrMFaJ2fG"}],"key":"gOyq8iJcQV"}],"key":"wj6EX8Lo3W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.S2.sel(time='2018-05-09', method='nearest').plot.imshow()","key":"InjSZdimqP"},{"type":"outputs","id":"0os1LmZca8EbRidejxyi_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4c8ed1ee9278874c32b4d925170a7b37","path":"/cubes-and-clouds/build/4c8ed1ee9278874c32b4d925170a7b37.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"jrY2wWjnwV"}],"key":"ZR9t0FU9mm"}],"key":"WDEoCrtW0s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cube.F1.sel(time='2018-04-02T10:24:35.000000000', method='nearest').plot.imshow()","key":"DR46xEHlCm"},{"type":"outputs","id":"DYlprK65USE8EhK0VG_CL","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2b612383b7bc6bb460b2e00f64ad80e2","path":"/cubes-and-clouds/build/2b612383b7bc6bb460b2e00f64ad80e2.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"NVgUlZ8l0c"}],"key":"JR7MSDfGWE"}],"key":"Jf5moasKaZ"}],"key":"BmZWrpIgza"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Sentinel-1","url":"/lectures/master-asi-conae/test/test-s1-s3","group":"Additional materials"}}},"domain":"http://localhost:3000"}