{"version":3,"kind":"Notebook","sha256":"17bee79e5f95be67c37a567b8c0ac225c80ecfcfa16711e827f494ac51b06227","slug":"lectures.data-access.exercises.openeo.openeo-data-access-filter","location":"/lectures/2.3_data_access/exercises/openeo/23_openeo_data_access_filter.ipynb","dependencies":[],"frontmatter":{"title":"2.3 Data Access and Basic Processing","content_includes_title":true,"kernelspec":{"name":"conda-env-cubes-and-clouds-cubes-and-clouds-cubes_and_clouds_new-py","display_name":"cubes-and-clouds-cubes-and-clouds-cubes_and_clouds_new","language":"python"},"github":"https://github.com/EO-college/cubes-and-clouds","subject":"Cubes and Clouds learning materials","numbering":{"title":{"offset":3}},"source_url":"https://github.com/EO-college/cubes-and-clouds/blob/main/lectures/2.3_data_access/exercises/openeo/23_openeo_data_access_filter.ipynb","edit_url":"https://github.com/EO-college/cubes-and-clouds/edit/main/lectures/2.3_data_access/exercises/openeo/23_openeo_data_access_filter.ipynb","thumbnail":"/cubes-and-clouds/build/56b77b9fff7f39fece234cf0910cdb55.svg","exports":[{"format":"ipynb","filename":"23_openeo_data_access_filter.ipynb","url":"/cubes-and-clouds/build/23_openeo_data_acces-a397f4c743a6477724ef737745a4fc9e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","children":[{"type":"image","style":{"float":"center","marginRight":"10px","marginLeft":"10px","maxHeight":"250px"},"url":"/cubes-and-clouds/build/56b77b9fff7f39fece234cf0910cdb55.svg","alt":"Cubes & Clouds logo","key":"CXR0hulPwy","urlSource":"https://raw.githubusercontent.com/EO-College/cubes-and-clouds/main/icons/cnc_3icons_process_circle.svg"}],"key":"cSPQ1syHE6"}],"key":"KhhGtZK2kn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.3 Data Access and Basic Processing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FsZPK8Uptn"}],"identifier":"id-2-3-data-access-and-basic-processing","label":"2.3 Data Access and Basic Processing","html_id":"id-2-3-data-access-and-basic-processing","implicit":true,"key":"OeZ5JpPHal"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","style":{"float":"center","marginRight":"10px","maxHeight":"100px"},"url":"/cubes-and-clouds/build/7d92286654718ed077e8b148b8c89bdd.png","alt":"openEO logo","key":"o2lJedvR5r","urlSource":"https://openeo.org/images/openeo_logo.png"}],"key":"mSGe83bWEJ"},{"type":"heading","depth":2,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Filter Operators with openEO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"E8cLPSuD42"}],"identifier":"filter-operators-with-openeo","label":"Filter Operators with openEO","html_id":"filter-operators-with-openeo","implicit":true,"key":"XQ86kghjKN"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"When interacting with large data collections, it is necessary to keep in mind that it’s not possible to load everything!","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"y2OcfZcRpF"}],"key":"VV9jxCwV7Q"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Therefore, we always have to define our requirements in advance and apply them to the data using filter operators.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ex6SG4CsX4"}],"key":"DDd6fZ8whM"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Let’s start again with the same sample data from the Sentinel-2 STAC Collection with an additional filter.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jqzWkH0wJ3"}],"key":"yJQP0xZ3ZH"}],"key":"yFP9L9mQJS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Properties Filter","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q6iDaqqj9W"}],"identifier":"properties-filter","label":"Properties Filter","html_id":"properties-filter","implicit":true,"key":"kUNZYNDlW8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"When working with optical data like Sentinel-2, most of the times we would like to discard cloudy acquisitions as soon as possible.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Dj9FRpTjZS"}],"key":"Md8KkjFTO2"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We can do it using a property filter: in this case we want to keep only the acquisitions with less than 50% cloud coverage.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iRTnkRJOJ6"}],"key":"svlgDi3qxS"}],"key":"JrYOQg3ZC8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"properties = {\"eo:cloud_cover\": dict(lt=50)}","key":"c1pZk3jKhe"},{"type":"outputs","id":"W-j4DwxtId489YAP-dmgd","children":[],"key":"HR37jgc8Gz"}],"key":"KYJVnsnRzt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import openeo\nfrom openeo.local import LocalConnection\nlocal_conn = LocalConnection('')\n\nurl = \"https://earth-search.aws.element84.com/v1/collections/sentinel-2-l2a\"\nspatial_extent = {\"west\": 11.1, \"east\": 11.5, \"south\": 46.1, \"north\": 46.5}\ntemporal_extent = [\"2023-04-01T00:00:00Z\",\"2023-11-30T00:00:00Z\"]\nbands = [\"red\",\"green\",\"blue\",\"nir\"]\n\ndatacube = local_conn.load_stac(url=url,\n                    spatial_extent=spatial_extent,\n                    temporal_extent=temporal_extent,\n                    bands=bands,\n                    properties=properties)\ndatacube.execute()","key":"ofiq0KhbCR"},{"type":"outputs","id":"kwn-n5OIVxB4i2VcUDaf_","children":[],"key":"ZqR5c4RKiM"}],"key":"Hgl8f4eV08"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Temporal Filter","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OAnqvHBneg"}],"identifier":"temporal-filter","label":"Temporal Filter","html_id":"temporal-filter","implicit":true,"key":"XFikWx3yxp"}],"key":"GkBb8t8Tl2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To filter along time the data collection with openEO, we can use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FfbYg28g4e"},{"type":"inlineCode","value":"filter_temporal","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pTPt7leDAU"},{"type":"text","value":" process.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cm3lTqlqqt"}],"key":"BsbodUMUKz"}],"key":"eJz8HJWjtJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"temporal_extent = [\"2023-05-10T00:00:00Z\",\"2023-06-30T00:00:00Z\"]\ntemporal_slice = datacube.filter_temporal(temporal_extent)\ntemporal_slice.execute()","key":"az6Tnn9b9n"},{"type":"outputs","id":"aaNCYDAbfof90InQ1aiK8","children":[],"key":"y3JObYulsm"}],"key":"WdnJGRjK8B"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After running the previous cell, it is visible that the result has less elements (or labels) in the temporal dimension ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JCrZHD9Ldx"},{"type":"inlineCode","value":"time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"en9YMGzQ1X"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W8MSm5wAhW"}],"key":"Yl5y4NEBz6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Additionally, the size of the selected data reduced a lot.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HkNil9ZZfz"}],"key":"oj6R0FKwCb"}],"key":"T7RuAOQ5uL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Quiz hint: look carefully at the dimensions of the resulting datacube!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kEh94rxCPw"}],"key":"WnOUB7bQuw"}],"key":"cEdMCuywKe"}],"key":"XMWDG8q4BH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Spatial Filter","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XashgHtnFq"}],"identifier":"spatial-filter","label":"Spatial Filter","html_id":"spatial-filter","implicit":true,"key":"d0yG4sChIj"}],"key":"KsSsKAPTZ2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To slice along the spatial dimensions the data collection with openEO, we can use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eUCK7az5U1"},{"type":"inlineCode","value":"filter_bbox","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VXBTiSuFQg"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eutv1Rn8Vs"},{"type":"inlineCode","value":"filter_spatial","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GujtyVN9vh"},{"type":"text","value":" processes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cB20HFOHm1"}],"key":"HnBSO6OPI3"}],"key":"hiDblWjX14"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yPiIcUgsIe"},{"type":"inlineCode","value":"filter_bbox","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RYgy9GJ2sJ"},{"type":"text","value":" process is used with a set of coordinates:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ck91O6vmlP"}],"key":"wPmgVTf33D"}],"key":"GPL8Oyq8gI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"spatial_extent = {\"west\": 11.259613, \"east\": 11.406212, \"south\": 46.461019, \"north\": 46.522237}\nspatial_slice = datacube.filter_bbox(spatial_extent)\nspatial_slice.execute()","key":"swV4TfTB6c"},{"type":"outputs","id":"ZHW6C0_be4XE1GfG-vGnw","children":[],"key":"myOUjqrxzf"}],"key":"u0rTruh0MC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Quiz hint: look carefully at the dimensions of the loaded datacube!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I7Rx0xSSCr"}],"key":"nTqg7s0pSh"}],"key":"qRdIggG1pk"}],"key":"VoLx8KrrAm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Bands Filter","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XjmfDlgiBr"}],"identifier":"bands-filter","label":"Bands Filter","html_id":"bands-filter","implicit":true,"key":"ioc4NrAKm2"}],"key":"F3m0FuTihm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To slice along the bands dimension, keeping only the necessary bands, we can use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ybnl2BXoRy"},{"type":"inlineCode","value":"filter_bands","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lh5d8QeWGN"},{"type":"text","value":" process.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XYuwBzxUlK"}],"key":"OlZGBrQzrC"}],"key":"hvBNzqtgt7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bands = [\"red\",\"green\",\"blue\"]\nbands_slice = datacube.filter_bands(bands)\nbands_slice.execute()","key":"rccR3ZYf7F"},{"type":"outputs","id":"ahcvx8I5P8XhIkK0RDQQD","children":[],"key":"SdI9uXCIHS"}],"key":"DDGk4y49BI"}],"key":"SMDsSk8BXU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"2.3 Data Access and Basic Processing","url":"/lectures/data-access/exercises/openeo/openeo-data-access-reduce","group":"Data access with OpenEO"},"next":{"title":"2.3 Data Access and Basic Processing","url":"/lectures/data-access/exercises/openeo/openeo-data-access-resample","group":"Data access with OpenEO"}}},"domain":"http://localhost:3000"}